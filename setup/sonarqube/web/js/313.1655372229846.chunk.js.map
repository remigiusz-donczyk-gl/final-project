{"version":3,"sources":["webpack:///./src/main/js/components/common/ProjectKeyInput.tsx","webpack:///./src/main/js/helpers/projects.ts","webpack:///./src/main/js/apps/create/project/ManualProjectCreate.css?95f7","webpack:///./src/main/js/apps/create/project/ManualProjectCreate.css","webpack:///./src/main/js/apps/create/project/style.css?00fe","webpack:///./src/main/js/apps/create/project/style.css","webpack:///./src/main/js/api/alm-integrations.ts","webpack:///./src/main/js/apps/create/project/AzurePersonalAccessTokenForm.tsx","webpack:///./src/main/js/apps/create/project/types.ts","webpack:///./src/main/js/apps/create/project/AzureProjectAccordion.tsx","webpack:///./src/main/js/apps/create/project/AzureProjectsList.tsx","webpack:///./src/main/js/apps/create/project/CreateProjectPageHeader.tsx","webpack:///./src/main/js/apps/create/project/WrongBindingCountAlert.tsx","webpack:///./src/main/js/apps/create/project/AzureProjectCreateRenderer.tsx","webpack:///./src/main/js/apps/create/project/AzureProjectCreate.tsx","webpack:///./src/main/js/apps/create/project/BitbucketProjectAccordion.tsx","webpack:///./src/main/js/apps/create/project/BitbucketRepositories.tsx","webpack:///./src/main/js/apps/create/project/BitbucketSearchResults.tsx","webpack:///./src/main/js/apps/create/project/BitbucketImportRepositoryForm.tsx","webpack:///./src/main/js/apps/create/project/PersonalAccessTokenForm.tsx","webpack:///./src/main/js/apps/create/project/BitbucketProjectCreateRenderer.tsx","webpack:///./src/main/js/apps/create/project/constants.ts","webpack:///./src/main/js/apps/create/project/BitbucketProjectCreate.tsx","webpack:///./src/main/js/apps/create/project/CreateProjectModeSelection.tsx","webpack:///./src/main/js/apps/create/project/GitHubProjectCreateRenderer.tsx","webpack:///./src/main/js/apps/create/project/GitHubProjectCreate.tsx","webpack:///./src/main/js/components/controls/ListFooter.tsx","webpack:///./src/main/js/apps/create/project/GitlabProjectSelectionForm.tsx","webpack:///./src/main/js/apps/create/project/GitlabProjectCreateRenderer.tsx","webpack:///./src/main/js/apps/create/project/GitlabProjectCreate.tsx","webpack:///./src/main/js/apps/create/project/ManualProjectCreate.tsx","webpack:///./src/main/js/apps/create/project/CreateProjectPage.tsx","webpack:///./src/main/js/app/components/a11y/A11ySkipTarget.tsx","webpack:///./src/main/js/api/alm-settings.ts","webpack:///./src/main/js/components/common/DocumentationTooltip.tsx","webpack:///./src/main/js/apps/settings/components/AdditionalCategoryKeys.ts","webpack:///./src/main/js/components/hoc/whenLoggedIn.tsx"],"names":["ProjectKeyInput","props","error","help","label","placeholder","projectKey","touched","validating","isInvalid","undefined","isValid","className","description","id","required","autoFocus","maxLength","minLength","onChange","onProjectKeyChange","type","value","validateProjectKey","length","Empty","TooLong","test","Valid","OnlyDigits","InvalidChar","api","content","__esModule","default","module","i","options","exported","locals","exports","___CSS_LOADER_API_IMPORT___","push","setAlmPersonalAccessToken","almSetting","pat","catch","throwGlobalError","checkPersonalAccessTokenIsValid","then","status","response","searchAzureRepositories","searchQuery","getGithubOrganizations","token","getGithubRepositories","data","organization","pageSize","page","query","p","ps","q","getGitlabProjects","projectName","projects","projectsPaging","importGitlabProject","gitlabProjectId","getAzurePatUrl","url","replace","AzurePersonalAccessTokenForm","alm","submitting","validationFailed","setTouched","errorMessage","setToken","defaultMessage","values","link","href","rel","target","scope","onSubmit","e","preventDefault","onPersonalAccessTokenCreate","name","disabled","loading","CreateProjectModes","highlight","text","term","underline","toLowerCase","includes","split","RegExp","pre","found","post","AzureProjectAccordion","importing","startsOpen","project","repositories","selectedRepository","open","setOpen","setPage","limitedRepositories","slice","isSelected","repo","onClick","onOpen","title","map","key","sqProjectKey","fill","green","size","to","sqProjectName","checked","onCheck","onSelectRepository","count","total","loadMore","Alert","variant","pathname","mode","AzureDevOps","resetPat","AzureProjectsList","loadingRepositories","searchResults","filteredProjects","filter","displayedProjects","keySuffix","Boolean","onOpenProject","CreateProjectPageHeader","additionalActions","WrongBindingCountAlert","canAdmin","category","AzureProjectCreateRenderer","searching","settings","showPersonalAccessTokenForm","submittingToken","tokenValidationFailed","onImportRepository","alt","height","src","Azure","onSearch","mounted","fetchInitialData","this","setState","checkPersonalAccessToken","patIsValid","fetchAzureProjects","state","firstProjectName","fetchAzureRepositories","repos","Promise","resolve","getAzureRepositories","cleanUrl","location","router","handleOpenProject","projectRepos","handleSearchRepositories","results","handleImportRepository","repositoryName","createdProject","onProjectCreate","handleSelectRepository","handlePersonalAccessTokenCreate","componentDidMount","componentDidUpdate","prevProps","componentWillUnmount","render","loadingBindings","BitbucketProjectAccordion","disableRepositories","showingAllRepositories","repositoryCount","BitbucketServer","String","BitbucketRepositories","projectRepositories","openProjectKeys","setOpenProjectKeys","allAreExpanded","isOpen","allShown","handleClick","BitbucketSearchResults","some","r","filteredProjectKeys","filteredSearchResults","BitbucketImportRepositoryForm","getPatUrl","endsWith","PersonalAccessTokenForm","validationErrorMessage","FormData","currentTarget","get","display","perm","GitLab","BitbucketProjectCreateRenderer","bitbucketSetting","fetchBitbucketProjects","fetchBitbucketRepositories","all","isLastPage","filteredRepositories","reduce","acc","repositorySlug","slug","handleSearch","bitbucketSettings","renderAlmOption","almCounts","tooltipLinks","onSelectMode","style","lineHeight","DocumentationTooltip","links","withAppState","GitHub","orgToOption","organizations","o","GitHubProjectCreateRenderer","loadingOrganizations","selectedOrganization","defaultOptions","minimumQueryLength","onSelect","onSelectOrganization","repositoryPaging","isDisabled","repository","onLoadMore","renderRepositoryList","triggerSearch","fetchRepositories","organizationKey","handleSelectOrganization","find","handleLoadMore","pageIndex","repositoryKey","initialize","code","redirectToGithub","fetchOrganizations","clientId","queryParams","param","join","instanceRootUrl","window","params","paging","button","needReload","ready","hasMore","reload","GitlabProjectSelectionForm","importingGitlabProjectId","loadingMore","overlay","qualifier","Project","pathSlug","pathName","onImport","GitlabProjectCreateRenderer","tokenValidationErrorMessage","fetchProjects","result","tokenIsValid","handleError","doImport","handleImport","checkFreeKey","component","alreadyExist","projectKeyError","handleFormSubmit","event","canSubmit","trim","handleProjectKeyChange","validateKey","prevState","projectNameChanged","projectNameError","validateName","handleProjectNameChange","projectNameIsInvalid","projectNameIsValid","azureSettings","githubSettings","gitlabSettings","fetchAlmBindings","almSettings","s","handleModeSelect","handleProjectCreate","projectKeys","renderForm","Manual","titleTemplate","A11ySkipTarget","anchor","whenLoggedIn","Consumer","addA11ySkipLink","removeA11ySkipLink","A11ySkipTargetInner","getLink","weight","getAlmDefinitions","getAlmSettings","getAlmSettingsNoCatch","validateAlmSettings","BadRequest","createGithubConfiguration","updateGithubConfiguration","createAzureConfiguration","updateAzureConfiguration","createBitbucketConfiguration","updateBitbucketConfiguration","createBitbucketCloudConfiguration","updateBitbucketCloudConfiguration","createGitlabConfiguration","updateGitlabConfiguration","deleteConfiguration","countBindedProjects","getProjectAlmBinding","deleteProjectAlmBinding","setProjectAzureBinding","setProjectBitbucketBinding","setProjectBitbucketCloudBinding","setProjectGithubBinding","setProjectGitlabBinding","inPlace","children","ALM_INTEGRATION","ANALYSIS_SCOPE_CATEGORY","LANGUAGES_CATEGORY","NEW_CODE_PERIOD_CATEGORY","PULL_REQUEST_DECORATION_BINDING_CATEGORY","WrappedComponent","currentUser","displayName","Wrapper"],"mappings":"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","file":"js/313.1655372229846.chunk.js","sourcesContent":["/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport ValidationInput from 'sonar-ui-common/components/controls/ValidationInput';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { PROJECT_KEY_MAX_LEN } from '../../helpers/constants';\n\nexport interface ProjectKeyInputProps {\n  error?: string;\n  help?: string;\n  label?: string;\n  onProjectKeyChange: (e: React.ChangeEvent<HTMLInputElement>) => void;\n  placeholder?: string;\n  projectKey?: string;\n  touched: boolean;\n  validating?: boolean;\n}\n\nexport default function ProjectKeyInput(props: ProjectKeyInputProps) {\n  const { error, help, label, placeholder, projectKey, touched, validating } = props;\n\n  const isInvalid = touched && error !== undefined;\n  const isValid = touched && !validating && error === undefined;\n\n  return (\n    <ValidationInput\n      className=\"form-field\"\n      description={translate('onboarding.create_project.project_key.description')}\n      error={error}\n      help={help}\n      id=\"project-key\"\n      isInvalid={isInvalid}\n      isValid={isValid}\n      label={label}\n      required={label !== undefined}>\n      <input\n        autoFocus={true}\n        className={classNames('input-super-large', {\n          'is-invalid': isInvalid,\n          'is-valid': isValid\n        })}\n        id=\"project-key\"\n        maxLength={PROJECT_KEY_MAX_LEN}\n        minLength={1}\n        onChange={props.onProjectKeyChange}\n        placeholder={placeholder}\n        type=\"text\"\n        value={projectKey}\n      />\n    </ValidationInput>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { ProjectKeyValidationResult } from '../types/component';\nimport { PROJECT_KEY_MAX_LEN } from './constants';\n\nexport function validateProjectKey(projectKey: string): ProjectKeyValidationResult {\n  // This is the regex used on the backend:\n  //   [\\p{Alnum}\\-_.:]*[\\p{Alpha}\\-_.:]+[\\p{Alnum}\\-_.:]*\n  // See sonar-core/src/main/java/org/sonar/core/component/ComponentKeys.java\n  const regex = /^[\\w\\-.:]*[a-z\\-_.:]+[\\w\\-.:]*$/i;\n  if (projectKey.length === 0) {\n    return ProjectKeyValidationResult.Empty;\n  } else if (projectKey.length > PROJECT_KEY_MAX_LEN) {\n    return ProjectKeyValidationResult.TooLong;\n  } else if (regex.test(projectKey)) {\n    return ProjectKeyValidationResult.Valid;\n  } else {\n    return /^[0-9]+$/.test(projectKey)\n      ? ProjectKeyValidationResult.OnlyDigits\n      : ProjectKeyValidationResult.InvalidChar;\n  }\n}\n","var api = require(\"!../../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../../../../node_modules/postcss-loader/src/index.js??postcss!./ManualProjectCreate.css\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\nvar exported = content.locals ? content.locals : {};\n\n\n\nmodule.exports = exported;","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".manual-project-create{max-width:700px}.manual-project-create .button{margin-top:8px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","var api = require(\"!../../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../../../../node_modules/postcss-loader/src/index.js??postcss!./style.css\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\nvar exported = content.locals ? content.locals : {};\n\n\n\nmodule.exports = exported;","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"#create-project{padding-top:0!important}#create-project header{padding-top:20px;background-color:#f3f3f3;position:-webkit-sticky;position:sticky;top:48px;z-index:50}.create-project-manual{display:flex!important;justify-content:space-between}.create-project-azdo-repo{width:410px;min-height:40px;box-sizing:border-box;margin-right:auto}.create-project-import-bbs .open .boxed-group-header{border-bottom:1px solid #e6e6e6}.create-project-import-bbs .boxed-group-inner{padding-top:24px}.create-project-import-bbs-repo{width:250px;min-height:40px}.create-project-github-repository{box-sizing:border-box;width:33.33%}.create-project-github-repository .notice{display:block;position:absolute}.create-project-github-repository .notice svg{color:#0a0}.create-project-import-gitlab table>tbody>tr>td{vertical-align:middle}.create-project-import-gitlab .project-name,.create-project-import-gitlab .project-path{max-width:400px}.create-project-import-gitlab .sq-project-link{max-width:300px}.create-project-import-gitlab .already-set-up svg{color:#0a0}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { get, getJSON, parseError, post, postJSON } from 'sonar-ui-common/helpers/request';\nimport throwGlobalError from '../app/utils/throwGlobalError';\nimport {\n  AzureProject,\n  AzureRepository,\n  BitbucketProject,\n  BitbucketRepository,\n  GithubOrganization,\n  GithubRepository,\n  GitlabProject\n} from '../types/alm-integration';\nimport { ProjectBase } from './components';\n\nexport function setAlmPersonalAccessToken(almSetting: string, pat: string): Promise<void> {\n  return post('/api/alm_integrations/set_pat', { almSetting, pat }).catch(throwGlobalError);\n}\n\nexport function checkPersonalAccessTokenIsValid(\n  almSetting: string\n): Promise<{ status: boolean; error?: string }> {\n  return get('/api/alm_integrations/check_pat', { almSetting })\n    .then(() => ({ status: true }))\n    .catch(async (response: Response) => {\n      if (response.status === 400) {\n        const error = await parseError(response);\n        return { status: false, error };\n      }\n      return throwGlobalError(response);\n    });\n}\n\nexport function getAzureProjects(almSetting: string): Promise<{ projects: AzureProject[] }> {\n  return getJSON('/api/alm_integrations/list_azure_projects', { almSetting }).catch(\n    throwGlobalError\n  );\n}\n\nexport function getAzureRepositories(\n  almSetting: string,\n  projectName: string\n): Promise<{ repositories: AzureRepository[] }> {\n  return getJSON('/api/alm_integrations/search_azure_repos', { almSetting, projectName }).catch(\n    throwGlobalError\n  );\n}\n\nexport function searchAzureRepositories(\n  almSetting: string,\n  searchQuery: string\n): Promise<{ repositories: AzureRepository[] }> {\n  return getJSON('/api/alm_integrations/search_azure_repos', { almSetting, searchQuery }).catch(\n    throwGlobalError\n  );\n}\n\nexport function importAzureRepository(\n  almSetting: string,\n  projectName: string,\n  repositoryName: string\n): Promise<{ project: ProjectBase }> {\n  return postJSON('/api/alm_integrations/import_azure_project', {\n    almSetting,\n    projectName,\n    repositoryName\n  }).catch(throwGlobalError);\n}\n\nexport function getBitbucketServerProjects(\n  almSetting: string\n): Promise<{ projects: BitbucketProject[] }> {\n  return getJSON('/api/alm_integrations/list_bitbucketserver_projects', { almSetting });\n}\n\nexport function getBitbucketServerRepositories(\n  almSetting: string,\n  projectName: string\n): Promise<{\n  isLastPage: boolean;\n  repositories: BitbucketRepository[];\n}> {\n  return getJSON('/api/alm_integrations/search_bitbucketserver_repos', {\n    almSetting,\n    projectName\n  });\n}\n\nexport function importBitbucketServerProject(\n  almSetting: string,\n  projectKey: string,\n  repositorySlug: string\n): Promise<{ project: ProjectBase }> {\n  return postJSON('/api/alm_integrations/import_bitbucketserver_project', {\n    almSetting,\n    projectKey,\n    repositorySlug\n  }).catch(throwGlobalError);\n}\n\nexport function searchForBitbucketServerRepositories(\n  almSetting: string,\n  repositoryName: string\n): Promise<{\n  isLastPage: boolean;\n  repositories: BitbucketRepository[];\n}> {\n  return getJSON('/api/alm_integrations/search_bitbucketserver_repos', {\n    almSetting,\n    repositoryName\n  });\n}\n\nexport function getGithubClientId(almSetting: string): Promise<{ clientId?: string }> {\n  return getJSON('/api/alm_integrations/get_github_client_id', { almSetting });\n}\n\nexport function importGithubRepository(\n  almSetting: string,\n  organization: string,\n  repositoryKey: string\n): Promise<{ project: ProjectBase }> {\n  return postJSON('/api/alm_integrations/import_github_project', {\n    almSetting,\n    organization,\n    repositoryKey\n  }).catch(throwGlobalError);\n}\n\nexport function getGithubOrganizations(\n  almSetting: string,\n  token: string\n): Promise<{ organizations: GithubOrganization[] }> {\n  return getJSON('/api/alm_integrations/list_github_organizations', {\n    almSetting,\n    token\n  }).catch((response?: Response) => {\n    if (response && response.status !== 400) {\n      throwGlobalError(response);\n    }\n  });\n}\n\nexport function getGithubRepositories(data: {\n  almSetting: string;\n  organization: string;\n  pageSize: number;\n  page?: number;\n  query?: string;\n}): Promise<{ repositories: GithubRepository[]; paging: T.Paging }> {\n  const { almSetting, organization, pageSize, page = 1, query } = data;\n  return getJSON('/api/alm_integrations/list_github_repositories', {\n    almSetting,\n    organization,\n    p: page,\n    ps: pageSize,\n    q: query || undefined\n  }).catch(throwGlobalError);\n}\n\nexport function getGitlabProjects(data: {\n  almSetting: string;\n  page?: number;\n  pageSize?: number;\n  query?: string;\n}): Promise<{ projects: GitlabProject[]; projectsPaging: T.Paging }> {\n  const { almSetting, pageSize, page, query } = data;\n  return getJSON('/api/alm_integrations/search_gitlab_repos', {\n    almSetting,\n    projectName: query || undefined,\n    p: page,\n    ps: pageSize\n  })\n    .then(({ repositories, paging }) => ({ projects: repositories, projectsPaging: paging }))\n    .catch(throwGlobalError);\n}\n\nexport function importGitlabProject(data: {\n  almSetting: string;\n  gitlabProjectId: string;\n}): Promise<{ project: ProjectBase }> {\n  const { almSetting, gitlabProjectId } = data;\n  return postJSON('/api/alm_integrations/import_gitlab_project', {\n    almSetting,\n    gitlabProjectId\n  }).catch(throwGlobalError);\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { SubmitButton } from 'sonar-ui-common/components/controls/buttons';\nimport ValidationInput from 'sonar-ui-common/components/controls/ValidationInput';\nimport DetachIcon from 'sonar-ui-common/components/icons/DetachIcon';\nimport DeferredSpinner from 'sonar-ui-common/components/ui/DeferredSpinner';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { AlmSettingsInstance } from '../../../types/alm-settings';\n\nexport interface AzurePersonalAccessTokenFormProps {\n  almSetting: AlmSettingsInstance;\n  onPersonalAccessTokenCreate: (token: string) => void;\n  submitting?: boolean;\n  validationFailed: boolean;\n}\n\nfunction getAzurePatUrl(url: string) {\n  return `${url.replace(/\\/$/, '')}/_usersSettings/tokens`;\n}\n\nexport default function AzurePersonalAccessTokenForm(props: AzurePersonalAccessTokenFormProps) {\n  const {\n    almSetting: { alm, url },\n    submitting = false,\n    validationFailed\n  } = props;\n\n  const [touched, setTouched] = React.useState(false);\n  React.useEffect(() => {\n    setTouched(false);\n  }, [submitting]);\n\n  const [token, setToken] = React.useState('');\n\n  const isInvalid = (validationFailed && !touched) || (touched && !token);\n\n  let errorMessage;\n  if (!token) {\n    errorMessage = translate('onboarding.create_project.pat_form.pat_required');\n  } else if (isInvalid) {\n    errorMessage = translate('onboarding.create_project.pat_incorrect', alm);\n  }\n\n  return (\n    <div className=\"boxed-group abs-width-600\">\n      <div className=\"boxed-group-inner\">\n        <h2>{translate('onboarding.create_project.pat_form.title', alm)}</h2>\n\n        <div className=\"big-spacer-top big-spacer-bottom\">\n          <FormattedMessage\n            id=\"onboarding.create_project.pat_help.instructions\"\n            defaultMessage={translate('onboarding.create_project.pat_help.instructions', alm)}\n            values={{\n              link: url ? (\n                <a\n                  className=\"link-with-icon\"\n                  href={getAzurePatUrl(url)}\n                  rel=\"noopener noreferrer\"\n                  target=\"_blank\">\n                  <DetachIcon className=\"little-spacer-right\" />\n                  <span>\n                    {translate('onboarding.create_project.pat_help.instructions.link', alm)}\n                  </span>\n                </a>\n              ) : (\n                translate('onboarding.create_project.pat_help.instructions.link', alm)\n              ),\n              scope: (\n                <strong>\n                  <em>Code (Read & Write)</em>\n                </strong>\n              )\n            }}\n          />\n        </div>\n\n        <form\n          onSubmit={(e: React.SyntheticEvent<HTMLFormElement>) => {\n            e.preventDefault();\n            props.onPersonalAccessTokenCreate(token);\n          }}>\n          <ValidationInput\n            error={errorMessage}\n            id=\"personal_access_token\"\n            isInvalid={isInvalid}\n            isValid={false}\n            label={translate('onboarding.create_project.enter_pat')}\n            required={true}>\n            <input\n              autoFocus={true}\n              className={classNames('width-100 little-spacer-bottom', {\n                'is-invalid': isInvalid\n              })}\n              id=\"personal_access_token\"\n              minLength={1}\n              name=\"personal_access_token\"\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n                setToken(e.target.value);\n                setTouched(true);\n              }}\n              type=\"text\"\n              value={token}\n            />\n          </ValidationInput>\n\n          <SubmitButton disabled={isInvalid || submitting || !touched}>\n            {translate('onboarding.create_project.pat_form.list_repositories')}\n          </SubmitButton>\n          <DeferredSpinner className=\"spacer-left\" loading={submitting} />\n        </form>\n      </div>\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nexport enum CreateProjectModes {\n  Manual = 'manual',\n  AzureDevOps = 'azure',\n  BitbucketServer = 'bitbucket',\n  GitHub = 'github',\n  GitLab = 'gitlab'\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { Link } from 'react-router';\nimport BoxedGroupAccordion from 'sonar-ui-common/components/controls/BoxedGroupAccordion';\nimport ListFooter from 'sonar-ui-common/components/controls/ListFooter';\nimport Radio from 'sonar-ui-common/components/controls/Radio';\nimport CheckIcon from 'sonar-ui-common/components/icons/CheckIcon';\nimport { Alert } from 'sonar-ui-common/components/ui/Alert';\nimport DeferredSpinner from 'sonar-ui-common/components/ui/DeferredSpinner';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { colors } from '../../../app/theme';\nimport { getProjectUrl } from '../../../helpers/urls';\nimport { AzureProject, AzureRepository } from '../../../types/alm-integration';\nimport { CreateProjectModes } from './types';\n\nexport interface AzureProjectAccordionProps {\n  importing: boolean;\n  loading: boolean;\n  onOpen: (key: string) => void;\n  onSelectRepository: (repository: AzureRepository) => void;\n  project: AzureProject;\n  repositories?: AzureRepository[];\n  searchQuery?: string;\n  selectedRepository?: AzureRepository;\n  startsOpen: boolean;\n}\n\nconst PAGE_SIZE = 30;\n\nfunction highlight(text: string, term?: string, underline = false) {\n  if (!term || !text.toLowerCase().includes(term.toLowerCase())) {\n    return text;\n  }\n\n  // Capture only the first occurence by using a capturing group to get\n  // everything after the first occurence\n  const [pre, found, post] = text.split(new RegExp(`(${term})(.*)`, 'i'));\n  return (\n    <>\n      {pre}\n      <strong className={classNames({ underline })}>{found}</strong>\n      {post}\n    </>\n  );\n}\n\nexport default function AzureProjectAccordion(props: AzureProjectAccordionProps) {\n  const {\n    importing,\n    loading,\n    startsOpen,\n    project,\n    repositories = [],\n    searchQuery,\n    selectedRepository\n  } = props;\n\n  const [open, setOpen] = React.useState(startsOpen);\n  const handleClick = () => {\n    if (!open) {\n      props.onOpen(project.name);\n    }\n    setOpen(!open);\n  };\n\n  const [page, setPage] = React.useState(1);\n  const limitedRepositories = repositories.slice(0, page * PAGE_SIZE);\n\n  const isSelected = (repo: AzureRepository) =>\n    selectedRepository?.projectName === project.name && selectedRepository.name === repo.name;\n\n  return (\n    <BoxedGroupAccordion\n      className={classNames('big-spacer-bottom', {\n        open\n      })}\n      onClick={handleClick}\n      open={open}\n      title={<h3 title={project.description}>{highlight(project.name, searchQuery, true)}</h3>}>\n      {open && (\n        <DeferredSpinner loading={loading}>\n          {/* The extra loading guard is to prevent the flash of the Alert */}\n          {!loading && repositories.length === 0 ? (\n            <Alert variant=\"warning\">\n              <FormattedMessage\n                defaultMessage={translate('onboarding.create_project.azure.no_repositories')}\n                id=\"onboarding.create_project.azure.no_repositories\"\n                values={{\n                  link: (\n                    <Link\n                      to={{\n                        pathname: '/projects/create',\n                        query: { mode: CreateProjectModes.AzureDevOps, resetPat: 1 }\n                      }}>\n                      {translate('onboarding.create_project.update_your_token')}\n                    </Link>\n                  )\n                }}\n              />\n            </Alert>\n          ) : (\n            <>\n              <div className=\"display-flex-wrap\">\n                {limitedRepositories.map(repo => (\n                  <div\n                    className=\"create-project-azdo-repo display-flex-start spacer-bottom padded-right\"\n                    key={repo.name}>\n                    {repo.sqProjectKey ? (\n                      <>\n                        <CheckIcon className=\"spacer-right\" fill={colors.green} size={14} />\n                        <div className=\"overflow-hidden\">\n                          <div className=\"little-spacer-bottom text-ellipsis\">\n                            <Link to={getProjectUrl(repo.sqProjectKey)} title={repo.sqProjectName}>\n                              {highlight(repo.sqProjectName || repo.name, searchQuery)}\n                            </Link>\n                          </div>\n                          <em>{translate('onboarding.create_project.repository_imported')}</em>\n                        </div>\n                      </>\n                    ) : (\n                      <Radio\n                        checked={isSelected(repo)}\n                        className=\"overflow-hidden\"\n                        disabled={importing}\n                        onCheck={() => props.onSelectRepository(repo)}\n                        value={repo.name}>\n                        <span className=\"text-ellipsis\" title={repo.name}>\n                          {highlight(repo.name, searchQuery)}\n                        </span>\n                      </Radio>\n                    )}\n                  </div>\n                ))}\n              </div>\n              <ListFooter\n                count={limitedRepositories.length}\n                total={repositories.length}\n                loadMore={() => setPage(p => p + 1)}\n              />\n            </>\n          )}\n        </DeferredSpinner>\n      )}\n    </BoxedGroupAccordion>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { Link } from 'react-router';\nimport ListFooter from 'sonar-ui-common/components/controls/ListFooter';\nimport { Alert } from 'sonar-ui-common/components/ui/Alert';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { AzureProject, AzureRepository } from '../../../types/alm-integration';\nimport AzureProjectAccordion from './AzureProjectAccordion';\nimport { CreateProjectModes } from './types';\n\nexport interface AzureProjectsListProps {\n  importing: boolean;\n  loadingRepositories: T.Dict<boolean>;\n  onOpenProject: (key: string) => void;\n  onSelectRepository: (repository: AzureRepository) => void;\n  projects?: AzureProject[];\n  repositories: T.Dict<AzureRepository[]>;\n  searchResults?: T.Dict<AzureRepository[]>;\n  searchQuery?: string;\n  selectedRepository?: AzureRepository;\n}\n\nconst PAGE_SIZE = 10;\n\nexport default function AzureProjectsList(props: AzureProjectsListProps) {\n  const {\n    importing,\n    loadingRepositories,\n    projects = [],\n    repositories,\n    searchResults,\n    searchQuery,\n    selectedRepository\n  } = props;\n\n  const [page, setPage] = React.useState(1);\n\n  const filteredProjects = searchResults\n    ? projects.filter(p => searchResults[p.name] !== undefined)\n    : projects;\n\n  if (filteredProjects.length === 0) {\n    return (\n      <Alert className=\"spacer-top\" variant=\"warning\">\n        {searchResults ? (\n          translate('onboarding.create_project.azure.no_results')\n        ) : (\n          <FormattedMessage\n            defaultMessage={translate('onboarding.create_project.azure.no_projects')}\n            id=\"onboarding.create_project.azure.no_projects\"\n            values={{\n              link: (\n                <Link\n                  to={{\n                    pathname: '/projects/create',\n                    query: { mode: CreateProjectModes.AzureDevOps, resetPat: 1 }\n                  }}>\n                  {translate('onboarding.create_project.update_your_token')}\n                </Link>\n              )\n            }}\n          />\n        )}\n      </Alert>\n    );\n  }\n\n  const displayedProjects = filteredProjects.slice(0, page * PAGE_SIZE);\n\n  // Add a suffix to the key to force react to not reuse AzureProjectAccordions between\n  // search results and project exploration\n  const keySuffix = searchResults ? ' - result' : '';\n\n  return (\n    <div>\n      {displayedProjects.map((p, i) => (\n        <AzureProjectAccordion\n          key={`${p.name}${keySuffix}`}\n          importing={importing}\n          loading={Boolean(loadingRepositories[p.name])}\n          onOpen={props.onOpenProject}\n          onSelectRepository={props.onSelectRepository}\n          project={p}\n          repositories={searchResults ? searchResults[p.name] : repositories[p.name]}\n          selectedRepository={selectedRepository}\n          searchQuery={searchQuery}\n          startsOpen={searchResults !== undefined || i === 0}\n        />\n      ))}\n\n      <ListFooter\n        count={displayedProjects.length}\n        loadMore={() => setPage(p => p + 1)}\n        total={filteredProjects.length}\n      />\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\n\nexport interface CreateProjectPageHeaderProps {\n  additionalActions?: React.ReactNode;\n  title: React.ReactNode;\n}\n\nexport default function CreateProjectPageHeader(props: CreateProjectPageHeaderProps) {\n  const { additionalActions, title } = props;\n\n  return (\n    <header className=\"huge-spacer-bottom bordered-bottom overflow-hidden\">\n      <h1 className=\"pull-left huge big-spacer-bottom\">{title}</h1>\n\n      {additionalActions}\n    </header>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { Link } from 'react-router';\nimport { Alert } from 'sonar-ui-common/components/ui/Alert';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { AlmKeys } from '../../../types/alm-settings';\nimport { ALM_INTEGRATION } from '../../settings/components/AdditionalCategoryKeys';\n\nexport interface WrongBindingCountAlertProps {\n  alm: AlmKeys;\n  canAdmin: boolean;\n}\n\nexport default function WrongBindingCountAlert(props: WrongBindingCountAlertProps) {\n  const { alm, canAdmin } = props;\n\n  return (\n    <Alert variant=\"error\">\n      {canAdmin ? (\n        <FormattedMessage\n          defaultMessage={translate('onboarding.create_project.wrong_binding_count.admin')}\n          id=\"onboarding.create_project.wrong_binding_count.admin\"\n          values={{\n            alm: translate('onboarding.alm', alm),\n            url: (\n              <Link\n                to={{\n                  pathname: '/admin/settings',\n                  query: { category: ALM_INTEGRATION }\n                }}>\n                {translate('settings.page')}\n              </Link>\n            )\n          }}\n        />\n      ) : (\n        <FormattedMessage\n          defaultMessage={translate('onboarding.create_project.wrong_binding_count')}\n          id=\"onboarding.create_project.wrong_binding_count\"\n          values={{\n            alm: translate('onboarding.alm', alm)\n          }}\n        />\n      )}\n    </Alert>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Button } from 'sonar-ui-common/components/controls/buttons';\nimport SearchBox from 'sonar-ui-common/components/controls/SearchBox';\nimport DeferredSpinner from 'sonar-ui-common/components/ui/DeferredSpinner';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { getBaseUrl } from 'sonar-ui-common/helpers/urls';\nimport { AzureProject, AzureRepository } from '../../../types/alm-integration';\nimport { AlmKeys, AlmSettingsInstance } from '../../../types/alm-settings';\nimport AzurePersonalAccessTokenForm from './AzurePersonalAccessTokenForm';\nimport AzureProjectsList from './AzureProjectsList';\nimport CreateProjectPageHeader from './CreateProjectPageHeader';\nimport WrongBindingCountAlert from './WrongBindingCountAlert';\n\nexport interface AzureProjectCreateRendererProps {\n  canAdmin?: boolean;\n  importing: boolean;\n  loading: boolean;\n  loadingRepositories: T.Dict<boolean>;\n  onImportRepository: () => void;\n  onOpenProject: (key: string) => void;\n  onPersonalAccessTokenCreate: (token: string) => void;\n  onSearch: (query: string) => void;\n  onSelectRepository: (repository: AzureRepository) => void;\n  projects?: AzureProject[];\n  repositories: T.Dict<AzureRepository[]>;\n  searching?: boolean;\n  searchResults?: T.Dict<AzureRepository[]>;\n  searchQuery?: string;\n  selectedRepository?: AzureRepository;\n  settings?: AlmSettingsInstance;\n  showPersonalAccessTokenForm?: boolean;\n  submittingToken?: boolean;\n  tokenValidationFailed: boolean;\n}\n\nexport default function AzureProjectCreateRenderer(props: AzureProjectCreateRendererProps) {\n  const {\n    canAdmin,\n    importing,\n    loading,\n    loadingRepositories,\n    projects,\n    repositories,\n    searching,\n    searchResults,\n    searchQuery,\n    selectedRepository,\n    settings,\n    showPersonalAccessTokenForm,\n    submittingToken,\n    tokenValidationFailed\n  } = props;\n\n  return (\n    <>\n      <CreateProjectPageHeader\n        additionalActions={\n          !showPersonalAccessTokenForm && (\n            <div className=\"display-flex-center pull-right\">\n              <DeferredSpinner className=\"spacer-right\" loading={importing} />\n              <Button\n                className=\"button-large button-primary\"\n                disabled={!selectedRepository || importing}\n                onClick={props.onImportRepository}>\n                {translate('onboarding.create_project.import_selected_repo')}\n              </Button>\n            </div>\n          )\n        }\n        title={\n          <span className=\"text-middle\">\n            <img\n              alt=\"\" // Should be ignored by screen readers\n              className=\"spacer-right\"\n              height=\"24\"\n              src={`${getBaseUrl()}/images/alm/azure.svg`}\n            />\n            {translate('onboarding.create_project.azure.title')}\n          </span>\n        }\n      />\n\n      {loading && <i className=\"spinner\" />}\n\n      {!loading && !(settings && settings.url) && (\n        <WrongBindingCountAlert alm={AlmKeys.Azure} canAdmin={!!canAdmin} />\n      )}\n\n      {!loading &&\n        settings &&\n        (showPersonalAccessTokenForm ? (\n          <div className=\"display-flex-justify-center\">\n            <AzurePersonalAccessTokenForm\n              almSetting={settings}\n              onPersonalAccessTokenCreate={props.onPersonalAccessTokenCreate}\n              submitting={submittingToken}\n              validationFailed={tokenValidationFailed}\n            />\n          </div>\n        ) : (\n          <>\n            <div className=\"huge-spacer-bottom\">\n              <SearchBox\n                onChange={props.onSearch}\n                placeholder={translate('onboarding.create_project.search_projects_repositories')}\n              />\n            </div>\n            <DeferredSpinner loading={Boolean(searching)}>\n              <AzureProjectsList\n                importing={importing}\n                loadingRepositories={loadingRepositories}\n                onOpenProject={props.onOpenProject}\n                onSelectRepository={props.onSelectRepository}\n                projects={projects}\n                repositories={repositories}\n                searchResults={searchResults}\n                searchQuery={searchQuery}\n                selectedRepository={selectedRepository}\n              />\n            </DeferredSpinner>\n          </>\n        ))}\n    </>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { groupBy } from 'lodash';\nimport * as React from 'react';\nimport { WithRouterProps } from 'react-router';\nimport {\n  checkPersonalAccessTokenIsValid,\n  getAzureProjects,\n  getAzureRepositories,\n  importAzureRepository,\n  searchAzureRepositories,\n  setAlmPersonalAccessToken\n} from '../../../api/alm-integrations';\nimport { AzureProject, AzureRepository } from '../../../types/alm-integration';\nimport { AlmSettingsInstance } from '../../../types/alm-settings';\nimport AzureCreateProjectRenderer from './AzureProjectCreateRenderer';\n\ninterface Props extends Pick<WithRouterProps, 'location' | 'router'> {\n  canAdmin: boolean;\n  loadingBindings: boolean;\n  onProjectCreate: (projectKeys: string[]) => void;\n  settings: AlmSettingsInstance[];\n}\n\ninterface State {\n  importing: boolean;\n  loading: boolean;\n  loadingRepositories: T.Dict<boolean>;\n  patIsValid?: boolean;\n  projects?: AzureProject[];\n  repositories: T.Dict<AzureRepository[]>;\n  searching?: boolean;\n  searchResults?: T.Dict<AzureRepository[]>;\n  searchQuery?: string;\n  selectedRepository?: AzureRepository;\n  settings?: AlmSettingsInstance;\n  submittingToken?: boolean;\n  tokenValidationFailed: boolean;\n}\n\nexport default class AzureProjectCreate extends React.PureComponent<Props, State> {\n  mounted = false;\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      // For now, we only handle a single instance. So we always use the first\n      // one from the list.\n      settings: props.settings[0],\n      importing: false,\n      loading: false,\n      loadingRepositories: {},\n      repositories: {},\n      tokenValidationFailed: false\n    };\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n    this.fetchInitialData();\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (prevProps.settings.length === 0 && this.props.settings.length > 0) {\n      this.setState(\n        { settings: this.props.settings.length === 1 ? this.props.settings[0] : undefined },\n        () => this.fetchInitialData()\n      );\n    }\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  fetchInitialData = async () => {\n    this.setState({ loading: true });\n\n    const patIsValid = await this.checkPersonalAccessToken().catch(() => false);\n\n    let projects: AzureProject[] | undefined;\n    if (patIsValid) {\n      projects = await this.fetchAzureProjects();\n    }\n\n    const { repositories } = this.state;\n\n    let firstProjectName: string;\n\n    if (projects && projects.length > 0) {\n      firstProjectName = projects[0].name;\n\n      this.setState(({ loadingRepositories }) => ({\n        loadingRepositories: { ...loadingRepositories, [firstProjectName]: true }\n      }));\n\n      const repos = await this.fetchAzureRepositories(firstProjectName);\n      repositories[firstProjectName] = repos;\n    }\n\n    if (this.mounted) {\n      this.setState(({ loadingRepositories }) => {\n        if (firstProjectName) {\n          loadingRepositories[firstProjectName] = false;\n        }\n\n        return {\n          patIsValid,\n          loading: false,\n          loadingRepositories: { ...loadingRepositories },\n          projects,\n          repositories\n        };\n      });\n    }\n  };\n\n  fetchAzureProjects = (): Promise<AzureProject[] | undefined> => {\n    const { settings } = this.state;\n\n    if (!settings) {\n      return Promise.resolve(undefined);\n    }\n\n    return getAzureProjects(settings.key).then(({ projects }) => projects);\n  };\n\n  fetchAzureRepositories = (projectName: string): Promise<AzureRepository[]> => {\n    const { settings } = this.state;\n\n    if (!settings) {\n      return Promise.resolve([]);\n    }\n\n    return getAzureRepositories(settings.key, projectName)\n      .then(({ repositories }) => repositories)\n      .catch(() => []);\n  };\n\n  cleanUrl = () => {\n    const { location, router } = this.props;\n    delete location.query.resetPat;\n    router.replace(location);\n  };\n\n  handleOpenProject = async (projectKey: string) => {\n    if (this.state.searchResults) {\n      return;\n    }\n\n    this.setState(({ loadingRepositories }) => ({\n      loadingRepositories: { ...loadingRepositories, [projectKey]: true }\n    }));\n\n    const projectRepos = await this.fetchAzureRepositories(projectKey);\n\n    this.setState(({ loadingRepositories, repositories }) => ({\n      loadingRepositories: { ...loadingRepositories, [projectKey]: false },\n      repositories: { ...repositories, [projectKey]: projectRepos }\n    }));\n  };\n\n  handleSearchRepositories = async (searchQuery: string) => {\n    const { settings } = this.state;\n\n    if (!settings) {\n      return;\n    }\n\n    if (searchQuery.length === 0) {\n      this.setState({ searchResults: undefined, searchQuery: undefined });\n      return;\n    }\n\n    this.setState({ searching: true });\n\n    const results: AzureRepository[] = await searchAzureRepositories(settings.key, searchQuery)\n      .then(({ repositories }) => repositories)\n      .catch(() => []);\n\n    if (this.mounted) {\n      this.setState({\n        searching: false,\n        searchResults: groupBy(results, 'projectName'),\n        searchQuery\n      });\n    }\n  };\n\n  handleImportRepository = async () => {\n    const { selectedRepository, settings } = this.state;\n\n    if (!settings || !selectedRepository) {\n      return;\n    }\n\n    this.setState({ importing: true });\n\n    const createdProject = await importAzureRepository(\n      settings.key,\n      selectedRepository.projectName,\n      selectedRepository.name\n    )\n      .then(({ project }) => project)\n      .catch(() => undefined);\n\n    if (this.mounted) {\n      this.setState({ importing: false });\n      if (createdProject) {\n        this.props.onProjectCreate([createdProject.key]);\n      }\n    }\n  };\n\n  handleSelectRepository = (selectedRepository: AzureRepository) => {\n    this.setState({ selectedRepository });\n  };\n\n  checkPersonalAccessToken = () => {\n    const { settings } = this.state;\n\n    if (!settings) {\n      return Promise.resolve(false);\n    }\n\n    return checkPersonalAccessTokenIsValid(settings.key).then(({ status }) => status);\n  };\n\n  handlePersonalAccessTokenCreate = async (token: string) => {\n    const { settings } = this.state;\n\n    if (!settings || token.length < 1) {\n      return;\n    }\n\n    this.setState({ submittingToken: true, tokenValidationFailed: false });\n\n    try {\n      await setAlmPersonalAccessToken(settings.key, token);\n      const patIsValid = await this.checkPersonalAccessToken();\n\n      if (this.mounted) {\n        this.setState({ submittingToken: false, patIsValid, tokenValidationFailed: !patIsValid });\n\n        if (patIsValid) {\n          this.cleanUrl();\n          this.fetchInitialData();\n        }\n      }\n    } catch (e) {\n      if (this.mounted) {\n        this.setState({ submittingToken: false });\n      }\n    }\n  };\n\n  render() {\n    const { canAdmin, loadingBindings, location } = this.props;\n    const {\n      importing,\n      loading,\n      loadingRepositories,\n      patIsValid,\n      projects,\n      repositories,\n      searching,\n      searchResults,\n      searchQuery,\n      selectedRepository,\n      settings,\n      submittingToken,\n      tokenValidationFailed\n    } = this.state;\n\n    return (\n      <AzureCreateProjectRenderer\n        canAdmin={canAdmin}\n        importing={importing}\n        loading={loading || loadingBindings}\n        loadingRepositories={loadingRepositories}\n        onImportRepository={this.handleImportRepository}\n        onOpenProject={this.handleOpenProject}\n        onPersonalAccessTokenCreate={this.handlePersonalAccessTokenCreate}\n        onSearch={this.handleSearchRepositories}\n        onSelectRepository={this.handleSelectRepository}\n        projects={projects}\n        repositories={repositories}\n        searching={searching}\n        searchResults={searchResults}\n        searchQuery={searchQuery}\n        selectedRepository={selectedRepository}\n        settings={settings}\n        showPersonalAccessTokenForm={!patIsValid || Boolean(location.query.resetPat)}\n        submittingToken={submittingToken}\n        tokenValidationFailed={tokenValidationFailed}\n      />\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { Link } from 'react-router';\nimport BoxedGroupAccordion from 'sonar-ui-common/components/controls/BoxedGroupAccordion';\nimport Radio from 'sonar-ui-common/components/controls/Radio';\nimport CheckIcon from 'sonar-ui-common/components/icons/CheckIcon';\nimport { Alert } from 'sonar-ui-common/components/ui/Alert';\nimport { translate, translateWithParameters } from 'sonar-ui-common/helpers/l10n';\nimport { colors } from '../../../app/theme';\nimport { getProjectUrl } from '../../../helpers/urls';\nimport { BitbucketProject, BitbucketRepository } from '../../../types/alm-integration';\nimport { CreateProjectModes } from './types';\n\nexport interface BitbucketProjectAccordionProps {\n  disableRepositories: boolean;\n  onClick?: () => void;\n  onSelectRepository: (repo: BitbucketRepository) => void;\n  open: boolean;\n  project?: BitbucketProject;\n  repositories: BitbucketRepository[];\n  selectedRepository?: BitbucketRepository;\n  showingAllRepositories: boolean;\n}\n\nexport default function BitbucketProjectAccordion(props: BitbucketProjectAccordionProps) {\n  const {\n    disableRepositories,\n    open,\n    project,\n    repositories,\n    selectedRepository,\n    showingAllRepositories\n  } = props;\n\n  const repositoryCount = repositories.length;\n\n  const title = project?.name ?? translate('search_results');\n\n  return (\n    <BoxedGroupAccordion\n      className={classNames('big-spacer-bottom', {\n        open,\n        'not-clickable': !props.onClick,\n        'no-hover': !props.onClick\n      })}\n      onClick={\n        props.onClick\n          ? props.onClick\n          : () => {\n              /* noop */\n            }\n      }\n      open={open}\n      title={<h3>{title}</h3>}>\n      {open && (\n        <>\n          <div className=\"display-flex-wrap\">\n            {repositoryCount === 0 && (\n              <Alert variant=\"warning\">\n                <FormattedMessage\n                  defaultMessage={translate('onboarding.create_project.no_bbs_repos')}\n                  id=\"onboarding.create_project.no_bbs_repos\"\n                  values={{\n                    link: (\n                      <Link\n                        to={{\n                          pathname: '/projects/create',\n                          query: { mode: CreateProjectModes.BitbucketServer, resetPat: 1 }\n                        }}>\n                        {translate('onboarding.create_project.update_your_token')}\n                      </Link>\n                    )\n                  }}\n                />\n              </Alert>\n            )}\n\n            {repositories.map(repo =>\n              repo.sqProjectKey ? (\n                <div\n                  className=\"display-flex-start spacer-right spacer-bottom create-project-import-bbs-repo\"\n                  key={repo.id}>\n                  <CheckIcon className=\"spacer-right\" fill={colors.green} size={14} />\n                  <div className=\"overflow-hidden\">\n                    <div className=\"little-spacer-bottom text-ellipsis\">\n                      <strong title={repo.name}>\n                        <Link to={getProjectUrl(repo.sqProjectKey)}>{repo.name}</Link>\n                      </strong>\n                    </div>\n                    <em>{translate('onboarding.create_project.repository_imported')}</em>\n                  </div>\n                </div>\n              ) : (\n                <Radio\n                  checked={selectedRepository?.id === repo.id}\n                  className={classNames(\n                    'display-flex-start spacer-right spacer-bottom create-project-import-bbs-repo overflow-hidden',\n                    {\n                      disabled: disableRepositories,\n                      'text-muted': disableRepositories,\n                      'link-no-underline': disableRepositories\n                    }\n                  )}\n                  key={repo.id}\n                  onCheck={() => props.onSelectRepository(repo)}\n                  value={String(repo.id)}>\n                  <strong className=\"text-ellipsis\" title={repo.name}>\n                    {repo.name}\n                  </strong>\n                </Radio>\n              )\n            )}\n          </div>\n\n          {!showingAllRepositories && repositoryCount > 0 && (\n            <Alert variant=\"warning\">\n              {translateWithParameters(\n                'onboarding.create_project.only_showing_X_first_repos',\n                repositoryCount\n              )}\n            </Alert>\n          )}\n        </>\n      )}\n    </BoxedGroupAccordion>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { uniq, without } from 'lodash';\nimport * as React from 'react';\nimport { ButtonLink } from 'sonar-ui-common/components/controls/buttons';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport {\n  BitbucketProject,\n  BitbucketProjectRepositories,\n  BitbucketRepository\n} from '../../../types/alm-integration';\nimport BitbucketProjectAccordion from './BitbucketProjectAccordion';\n\nexport interface BitbucketRepositoriesProps {\n  disableRepositories: boolean;\n  onSelectRepository: (repo: BitbucketRepository) => void;\n  projects: BitbucketProject[];\n  projectRepositories: BitbucketProjectRepositories;\n  selectedRepository?: BitbucketRepository;\n}\n\nexport default function BitbucketRepositories(props: BitbucketRepositoriesProps) {\n  const { disableRepositories, projects, projectRepositories, selectedRepository } = props;\n\n  const [openProjectKeys, setOpenProjectKeys] = React.useState(\n    projects.length > 0 ? [projects[0].key] : []\n  );\n\n  const allAreExpanded = projects.length <= openProjectKeys.length;\n\n  const handleClick = (isOpen: boolean, projectKey: string) => {\n    setOpenProjectKeys(\n      isOpen ? without(openProjectKeys, projectKey) : uniq([...openProjectKeys, projectKey])\n    );\n  };\n\n  return (\n    <>\n      <div className=\"overflow-hidden spacer-bottom\">\n        <ButtonLink\n          className=\"pull-right\"\n          onClick={() => setOpenProjectKeys(allAreExpanded ? [] : projects.map(p => p.key))}>\n          {allAreExpanded ? translate('collapse_all') : translate('expand_all')}\n        </ButtonLink>\n      </div>\n\n      {projects.map(project => {\n        const isOpen = openProjectKeys.includes(project.key);\n        const { allShown, repositories = [] } = projectRepositories[project.key] || {};\n\n        return (\n          <BitbucketProjectAccordion\n            disableRepositories={disableRepositories}\n            key={project.key}\n            onClick={() => handleClick(isOpen, project.key)}\n            onSelectRepository={props.onSelectRepository}\n            open={isOpen}\n            project={project}\n            repositories={repositories}\n            selectedRepository={selectedRepository}\n            showingAllRepositories={allShown}\n          />\n        );\n      })}\n    </>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Alert } from 'sonar-ui-common/components/ui/Alert';\nimport DeferredSpinner from 'sonar-ui-common/components/ui/DeferredSpinner';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { BitbucketProject, BitbucketRepository } from '../../../types/alm-integration';\nimport BitbucketProjectAccordion from './BitbucketProjectAccordion';\n\nexport interface BitbucketSearchResultsProps {\n  disableRepositories: boolean;\n  onSelectRepository: (repo: BitbucketRepository) => void;\n  projects: BitbucketProject[];\n  searching: boolean;\n  searchResults?: BitbucketRepository[];\n  selectedRepository?: BitbucketRepository;\n}\n\nexport default function BitbucketSearchResults(props: BitbucketSearchResultsProps) {\n  const {\n    disableRepositories,\n    projects,\n    searching,\n    searchResults = [],\n    selectedRepository\n  } = props;\n\n  if (searchResults.length === 0 && !searching) {\n    return (\n      <Alert className=\"big-spacer-top\" variant=\"warning\">\n        {translate('onboarding.create_project.no_bbs_repos.filter')}\n      </Alert>\n    );\n  }\n\n  const filteredProjects = projects.filter(p => searchResults.some(r => r.projectKey === p.key));\n  const filteredProjectKeys = filteredProjects.map(p => p.key);\n  const filteredSearchResults = searchResults.filter(\n    r => !filteredProjectKeys.includes(r.projectKey)\n  );\n\n  return (\n    <div className=\"big-spacer-top\">\n      <DeferredSpinner loading={searching}>\n        {filteredSearchResults.length > 0 && (\n          <BitbucketProjectAccordion\n            disableRepositories={disableRepositories}\n            onSelectRepository={props.onSelectRepository}\n            open={true}\n            repositories={filteredSearchResults}\n            selectedRepository={selectedRepository}\n            showingAllRepositories={true}\n          />\n        )}\n\n        {filteredProjects.map(project => {\n          const repositories = searchResults.filter(r => r.projectKey === project.key);\n\n          return (\n            <BitbucketProjectAccordion\n              disableRepositories={disableRepositories}\n              key={project.key}\n              onSelectRepository={props.onSelectRepository}\n              open={true}\n              project={project}\n              repositories={repositories}\n              selectedRepository={selectedRepository}\n              showingAllRepositories={true}\n            />\n          );\n        })}\n      </DeferredSpinner>\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { Link } from 'react-router';\nimport SearchBox from 'sonar-ui-common/components/controls/SearchBox';\nimport { Alert } from 'sonar-ui-common/components/ui/Alert';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport {\n  BitbucketProject,\n  BitbucketProjectRepositories,\n  BitbucketRepository\n} from '../../../types/alm-integration';\nimport BitbucketRepositories from './BitbucketRepositories';\nimport BitbucketSearchResults from './BitbucketSearchResults';\nimport { CreateProjectModes } from './types';\n\nexport interface BitbucketImportRepositoryFormProps {\n  disableRepositories: boolean;\n  onSearch: (query: string) => void;\n  onSelectRepository: (repo: BitbucketRepository) => void;\n  projects?: BitbucketProject[];\n  projectRepositories?: BitbucketProjectRepositories;\n  searching: boolean;\n  searchResults?: BitbucketRepository[];\n  selectedRepository?: BitbucketRepository;\n}\n\nexport default function BitbucketImportRepositoryForm(props: BitbucketImportRepositoryFormProps) {\n  const {\n    disableRepositories,\n    projects = [],\n    projectRepositories = {},\n    searchResults,\n    searching,\n    selectedRepository\n  } = props;\n\n  if (projects.length === 0) {\n    return (\n      <Alert className=\"spacer-top\" variant=\"warning\">\n        <FormattedMessage\n          defaultMessage={translate('onboarding.create_project.no_bbs_projects')}\n          id=\"onboarding.create_project.no_bbs_projects\"\n          values={{\n            link: (\n              <Link\n                to={{\n                  pathname: '/projects/create',\n                  query: { mode: CreateProjectModes.BitbucketServer, resetPat: 1 }\n                }}>\n                {translate('onboarding.create_project.update_your_token')}\n              </Link>\n            )\n          }}\n        />\n      </Alert>\n    );\n  }\n\n  return (\n    <div className=\"create-project-import-bbs\">\n      <SearchBox\n        onChange={props.onSearch}\n        placeholder={translate('onboarding.create_project.search_repositories_by_name')}\n      />\n\n      {searching || searchResults ? (\n        <BitbucketSearchResults\n          disableRepositories={disableRepositories}\n          onSelectRepository={props.onSelectRepository}\n          projects={projects}\n          searchResults={searchResults}\n          searching={searching}\n          selectedRepository={selectedRepository}\n        />\n      ) : (\n        <BitbucketRepositories\n          disableRepositories={disableRepositories}\n          onSelectRepository={props.onSelectRepository}\n          projectRepositories={projectRepositories}\n          projects={projects}\n          selectedRepository={selectedRepository}\n        />\n      )}\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { SubmitButton } from 'sonar-ui-common/components/controls/buttons';\nimport ValidationInput from 'sonar-ui-common/components/controls/ValidationInput';\nimport { Alert } from 'sonar-ui-common/components/ui/Alert';\nimport DeferredSpinner from 'sonar-ui-common/components/ui/DeferredSpinner';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { getBaseUrl } from 'sonar-ui-common/helpers/urls';\nimport { AlmKeys, AlmSettingsInstance } from '../../../types/alm-settings';\n\nexport interface PersonalAccessTokenFormProps {\n  almSetting: AlmSettingsInstance;\n  onPersonalAccessTokenCreate: (token: string) => void;\n  submitting?: boolean;\n  validationFailed: boolean;\n  validationErrorMessage?: string;\n}\n\nfunction getPatUrl(alm: AlmKeys, url: string) {\n  if (alm === AlmKeys.BitbucketServer) {\n    return `${url.replace(/\\/$/, '')}/plugins/servlet/access-tokens/add`;\n  } else {\n    // GitLab\n    return url.endsWith('/api/v4')\n      ? `${url.replace('/api/v4', '').replace(/\\/$/, '')}/profile/personal_access_tokens`\n      : 'https://docs.gitlab.com/ee/user/profile/personal_access_tokens.html#creating-a-personal-access-token';\n  }\n}\n\nexport default function PersonalAccessTokenForm(props: PersonalAccessTokenFormProps) {\n  const {\n    almSetting: { alm, url },\n    submitting = false,\n    validationFailed,\n    validationErrorMessage\n  } = props;\n  const [touched, setTouched] = React.useState(false);\n\n  React.useEffect(() => {\n    setTouched(false);\n  }, [submitting]);\n\n  const isInvalid = validationFailed && !touched;\n  const errorMessage =\n    validationErrorMessage ?? translate('onboarding.create_project.pat_incorrect', alm);\n\n  return (\n    <div className=\"display-flex-start\">\n      <form\n        className=\"width-50\"\n        onSubmit={(e: React.SyntheticEvent<HTMLFormElement>) => {\n          e.preventDefault();\n          const value = new FormData(e.currentTarget).get('personal_access_token') as string;\n          props.onPersonalAccessTokenCreate(value);\n        }}>\n        <h2 className=\"big\">{translate('onboarding.create_project.pat_form.title', alm)}</h2>\n        <p className=\"big-spacer-top big-spacer-bottom\">\n          {translate('onboarding.create_project.pat_form.help', alm)}\n        </p>\n\n        <ValidationInput\n          error={isInvalid ? errorMessage : undefined}\n          id=\"personal_access_token\"\n          isInvalid={isInvalid}\n          isValid={false}\n          label={translate('onboarding.create_project.enter_pat')}\n          required={true}>\n          <input\n            autoFocus={true}\n            className={classNames('input-super-large', {\n              'is-invalid': isInvalid\n            })}\n            id=\"personal_access_token\"\n            minLength={1}\n            name=\"personal_access_token\"\n            onChange={() => {\n              setTouched(true);\n            }}\n            type=\"text\"\n          />\n        </ValidationInput>\n\n        <SubmitButton disabled={isInvalid || submitting || !touched}>\n          {translate('save')}\n        </SubmitButton>\n        <DeferredSpinner className=\"spacer-left\" loading={submitting} />\n      </form>\n\n      <Alert className=\"big-spacer-left width-50\" display=\"block\" variant=\"info\">\n        <h3>{translate('onboarding.create_project.pat_help.title')}</h3>\n\n        <p className=\"big-spacer-top big-spacer-bottom\">\n          <FormattedMessage\n            id=\"onboarding.create_project.pat_help.instructions\"\n            defaultMessage={translate('onboarding.create_project.pat_help.instructions')}\n            values={{ alm: translate('onboarding.alm', alm) }}\n          />\n        </p>\n\n        {url && (\n          <div className=\"text-middle\">\n            <img\n              alt=\"\" // Should be ignored by screen readers\n              className=\"spacer-right\"\n              height=\"16\"\n              src={`${getBaseUrl()}/images/alm/${alm}.svg`}\n            />\n            <a href={getPatUrl(alm, url)} rel=\"noopener noreferrer\" target=\"_blank\">\n              {translate('onboarding.create_project.pat_help.link')}\n            </a>\n          </div>\n        )}\n\n        <p className=\"big-spacer-top big-spacer-bottom\">\n          {translate('onboarding.create_project.pat_help.instructions2', alm)}\n        </p>\n\n        <ul>\n          {alm === AlmKeys.BitbucketServer && (\n            <>\n              <li>\n                <FormattedMessage\n                  defaultMessage={translate(\n                    'onboarding.create_project.pat_help.bbs_permission_projects'\n                  )}\n                  id=\"onboarding.create_project.pat_help.bbs_permission_projects\"\n                  values={{\n                    perm: (\n                      <strong>\n                        {translate('onboarding.create_project.pat_help.read_permission')}\n                      </strong>\n                    )\n                  }}\n                />\n              </li>\n              <li>\n                <FormattedMessage\n                  defaultMessage={translate(\n                    'onboarding.create_project.pat_help.bbs_permission_repos'\n                  )}\n                  id=\"onboarding.create_project.pat_help.bbs_permission_repos\"\n                  values={{\n                    perm: (\n                      <strong>\n                        {translate('onboarding.create_project.pat_help.read_permission')}\n                      </strong>\n                    )\n                  }}\n                />\n              </li>\n            </>\n          )}\n          {alm === AlmKeys.GitLab && (\n            <li className=\"spacer-bottom\">\n              <strong>\n                {translate('onboarding.create_project.pat_help.gitlab.read_api_permission')}\n              </strong>\n            </li>\n          )}\n        </ul>\n      </Alert>\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Button } from 'sonar-ui-common/components/controls/buttons';\nimport DeferredSpinner from 'sonar-ui-common/components/ui/DeferredSpinner';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { getBaseUrl } from 'sonar-ui-common/helpers/urls';\nimport {\n  BitbucketProject,\n  BitbucketProjectRepositories,\n  BitbucketRepository\n} from '../../../types/alm-integration';\nimport { AlmKeys, AlmSettingsInstance } from '../../../types/alm-settings';\nimport BitbucketImportRepositoryForm from './BitbucketImportRepositoryForm';\nimport CreateProjectPageHeader from './CreateProjectPageHeader';\nimport PersonalAccessTokenForm from './PersonalAccessTokenForm';\nimport WrongBindingCountAlert from './WrongBindingCountAlert';\n\nexport interface BitbucketProjectCreateRendererProps {\n  bitbucketSetting?: AlmSettingsInstance;\n  canAdmin?: boolean;\n  importing: boolean;\n  loading: boolean;\n  onImportRepository: () => void;\n  onSearch: (query: string) => void;\n  onSelectRepository: (repo: BitbucketRepository) => void;\n  onPersonalAccessTokenCreate: (token: string) => void;\n  onProjectCreate: (projectKeys: string[]) => void;\n  projects?: BitbucketProject[];\n  projectRepositories?: BitbucketProjectRepositories;\n  searching: boolean;\n  searchResults?: BitbucketRepository[];\n  selectedRepository?: BitbucketRepository;\n  showPersonalAccessTokenForm?: boolean;\n  submittingToken?: boolean;\n  tokenValidationFailed: boolean;\n}\n\nexport default function BitbucketProjectCreateRenderer(props: BitbucketProjectCreateRendererProps) {\n  const {\n    bitbucketSetting,\n    canAdmin,\n    importing,\n    loading,\n    projects,\n    projectRepositories,\n    selectedRepository,\n    searching,\n    searchResults,\n    showPersonalAccessTokenForm,\n    submittingToken,\n    tokenValidationFailed\n  } = props;\n\n  return (\n    <>\n      <CreateProjectPageHeader\n        additionalActions={\n          !showPersonalAccessTokenForm && (\n            <div className=\"display-flex-center pull-right\">\n              <DeferredSpinner className=\"spacer-right\" loading={importing} />\n              <Button\n                className=\"button-large button-primary\"\n                disabled={!selectedRepository || importing}\n                onClick={props.onImportRepository}>\n                {translate('onboarding.create_project.import_selected_repo')}\n              </Button>\n            </div>\n          )\n        }\n        title={\n          <span className=\"text-middle\">\n            <img\n              alt=\"\" // Should be ignored by screen readers\n              className=\"spacer-right\"\n              height=\"24\"\n              src={`${getBaseUrl()}/images/alm/bitbucket.svg`}\n            />\n            {translate('onboarding.create_project.from_bbs')}\n          </span>\n        }\n      />\n\n      {loading && <i className=\"spinner\" />}\n\n      {!loading && !bitbucketSetting && (\n        <WrongBindingCountAlert alm={AlmKeys.BitbucketServer} canAdmin={!!canAdmin} />\n      )}\n\n      {!loading &&\n        bitbucketSetting &&\n        (showPersonalAccessTokenForm ? (\n          <PersonalAccessTokenForm\n            almSetting={bitbucketSetting}\n            onPersonalAccessTokenCreate={props.onPersonalAccessTokenCreate}\n            submitting={submittingToken}\n            validationFailed={tokenValidationFailed}\n          />\n        ) : (\n          <BitbucketImportRepositoryForm\n            disableRepositories={importing}\n            onSearch={props.onSearch}\n            onSelectRepository={props.onSelectRepository}\n            projectRepositories={projectRepositories}\n            projects={projects}\n            searchResults={searchResults}\n            searching={searching}\n            selectedRepository={selectedRepository}\n          />\n        ))}\n    </>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nexport const PROJECT_NAME_MAX_LEN = 255;\n\nexport const DEFAULT_BBS_PAGE_SIZE = 25;\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { WithRouterProps } from 'react-router';\nimport {\n  checkPersonalAccessTokenIsValid,\n  getBitbucketServerProjects,\n  getBitbucketServerRepositories,\n  importBitbucketServerProject,\n  searchForBitbucketServerRepositories,\n  setAlmPersonalAccessToken\n} from '../../../api/alm-integrations';\nimport {\n  BitbucketProject,\n  BitbucketProjectRepositories,\n  BitbucketRepository\n} from '../../../types/alm-integration';\nimport { AlmSettingsInstance } from '../../../types/alm-settings';\nimport BitbucketCreateProjectRenderer from './BitbucketProjectCreateRenderer';\nimport { DEFAULT_BBS_PAGE_SIZE } from './constants';\n\ninterface Props extends Pick<WithRouterProps, 'location'> {\n  canAdmin: boolean;\n  bitbucketSettings: AlmSettingsInstance[];\n  loadingBindings: boolean;\n  onProjectCreate: (projectKeys: string[]) => void;\n}\n\ninterface State {\n  bitbucketSetting?: AlmSettingsInstance;\n  importing: boolean;\n  loading: boolean;\n  patIsValid?: boolean;\n  projects?: BitbucketProject[];\n  projectRepositories?: BitbucketProjectRepositories;\n  searching: boolean;\n  searchResults?: BitbucketRepository[];\n  selectedRepository?: BitbucketRepository;\n  submittingToken?: boolean;\n  tokenValidationFailed: boolean;\n}\n\nexport default class BitbucketProjectCreate extends React.PureComponent<Props, State> {\n  mounted = false;\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      // For now, we only handle a single instance. So we always use the first\n      // one from the list.\n      bitbucketSetting: props.bitbucketSettings[0],\n      importing: false,\n      loading: false,\n      searching: false,\n      tokenValidationFailed: false\n    };\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n    this.fetchInitialData();\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (prevProps.bitbucketSettings.length === 0 && this.props.bitbucketSettings.length > 0) {\n      this.setState({ bitbucketSetting: this.props.bitbucketSettings[0] }, () =>\n        this.fetchInitialData()\n      );\n    }\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  fetchInitialData = async () => {\n    this.setState({ loading: true });\n\n    const patIsValid = await this.checkPersonalAccessToken().catch(() => false);\n\n    let projects;\n    if (patIsValid) {\n      projects = await this.fetchBitbucketProjects().catch(() => undefined);\n    }\n\n    let projectRepositories;\n    if (projects && projects.length > 0) {\n      projectRepositories = await this.fetchBitbucketRepositories(projects).catch(() => undefined);\n    }\n\n    if (this.mounted) {\n      this.setState({\n        patIsValid,\n        projects,\n        projectRepositories,\n        loading: false\n      });\n    }\n  };\n\n  checkPersonalAccessToken = () => {\n    const { bitbucketSetting } = this.state;\n\n    if (!bitbucketSetting) {\n      return Promise.resolve(false);\n    }\n\n    return checkPersonalAccessTokenIsValid(bitbucketSetting.key).then(({ status }) => status);\n  };\n\n  fetchBitbucketProjects = (): Promise<BitbucketProject[] | undefined> => {\n    const { bitbucketSetting } = this.state;\n\n    if (!bitbucketSetting) {\n      return Promise.resolve(undefined);\n    }\n\n    return getBitbucketServerProjects(bitbucketSetting.key).then(({ projects }) => projects);\n  };\n\n  fetchBitbucketRepositories = (\n    projects: BitbucketProject[]\n  ): Promise<BitbucketProjectRepositories | undefined> => {\n    const { bitbucketSetting } = this.state;\n\n    if (!bitbucketSetting) {\n      return Promise.resolve(undefined);\n    }\n\n    return Promise.all(\n      projects.map(p => {\n        return getBitbucketServerRepositories(bitbucketSetting.key, p.name).then(\n          ({ isLastPage, repositories }) => {\n            // Because the WS uses the project name rather than its key to find\n            // repositories, we can match more repositories than we expect. For\n            // example, p.name = \"A1\" would find repositories for projects \"A1\",\n            // \"A10\", \"A11\", etc. This is a limitation of BBS. To make sure we\n            // don't display incorrect information, filter on the project key.\n            const filteredRepositories = repositories.filter(r => r.projectKey === p.key);\n\n            // And because of the above, the \"isLastPage\" cannot be relied upon\n            // either. This one is impossible to get 100% for now. We can only\n            // make some assumptions: by default, the page size for BBS is 25\n            // (this is not part of the payload, so we don't know the actual\n            // number; but changing this implies changing some advanced config,\n            // so it's not likely). If the filtered repos is larger than this\n            // number AND isLastPage is false, we'll keep it at false.\n            // Otherwise, we assume it's true.\n            const realIsLastPage =\n              isLastPage || filteredRepositories.length < DEFAULT_BBS_PAGE_SIZE;\n\n            return {\n              repositories: filteredRepositories,\n              isLastPage: realIsLastPage,\n              projectKey: p.key\n            };\n          }\n        );\n      })\n    ).then(results => {\n      return results.reduce(\n        (acc: BitbucketProjectRepositories, { isLastPage, projectKey, repositories }) => {\n          return { ...acc, [projectKey]: { allShown: isLastPage, repositories } };\n        },\n        {}\n      );\n    });\n  };\n\n  handlePersonalAccessTokenCreate = (token: string) => {\n    const { bitbucketSetting } = this.state;\n\n    if (!bitbucketSetting || token.length < 1) {\n      return;\n    }\n\n    this.setState({ submittingToken: true, tokenValidationFailed: false });\n    setAlmPersonalAccessToken(bitbucketSetting.key, token)\n      .then(this.checkPersonalAccessToken)\n      .then(patIsValid => {\n        if (this.mounted) {\n          this.setState({ submittingToken: false, patIsValid, tokenValidationFailed: !patIsValid });\n          if (patIsValid) {\n            this.fetchInitialData();\n          }\n        }\n      })\n      .catch(() => {\n        if (this.mounted) {\n          this.setState({ submittingToken: false });\n        }\n      });\n  };\n\n  handleImportRepository = () => {\n    const { bitbucketSetting, selectedRepository } = this.state;\n\n    if (!bitbucketSetting || !selectedRepository) {\n      return;\n    }\n\n    this.setState({ importing: true });\n    importBitbucketServerProject(\n      bitbucketSetting.key,\n      selectedRepository.projectKey,\n      selectedRepository.slug\n    )\n      .then(({ project: { key } }) => {\n        if (this.mounted) {\n          this.setState({ importing: false });\n          this.props.onProjectCreate([key]);\n        }\n      })\n      .catch(() => {\n        if (this.mounted) {\n          this.setState({ importing: false });\n        }\n      });\n  };\n\n  handleSearch = (query: string) => {\n    const { bitbucketSetting } = this.state;\n\n    if (!bitbucketSetting) {\n      return;\n    }\n\n    if (!query) {\n      this.setState({ searching: false, searchResults: undefined, selectedRepository: undefined });\n      return;\n    }\n\n    this.setState({ searching: true, selectedRepository: undefined });\n    searchForBitbucketServerRepositories(bitbucketSetting.key, query)\n      .then(({ repositories }) => {\n        if (this.mounted) {\n          this.setState({ searching: false, searchResults: repositories });\n        }\n      })\n      .catch(() => {\n        if (this.mounted) {\n          this.setState({ searching: false });\n        }\n      });\n  };\n\n  handleSelectRepository = (selectedRepository: BitbucketRepository) => {\n    this.setState({ selectedRepository });\n  };\n\n  render() {\n    const { canAdmin, loadingBindings, location } = this.props;\n    const {\n      bitbucketSetting,\n      importing,\n      loading,\n      patIsValid,\n      projectRepositories,\n      projects,\n      searching,\n      searchResults,\n      selectedRepository,\n      submittingToken,\n      tokenValidationFailed\n    } = this.state;\n\n    return (\n      <BitbucketCreateProjectRenderer\n        bitbucketSetting={bitbucketSetting}\n        canAdmin={canAdmin}\n        importing={importing}\n        loading={loading || loadingBindings}\n        onImportRepository={this.handleImportRepository}\n        onPersonalAccessTokenCreate={this.handlePersonalAccessTokenCreate}\n        onProjectCreate={this.props.onProjectCreate}\n        onSearch={this.handleSearch}\n        onSelectRepository={this.handleSelectRepository}\n        projectRepositories={projectRepositories}\n        projects={projects}\n        searchResults={searchResults}\n        searching={searching}\n        selectedRepository={selectedRepository}\n        showPersonalAccessTokenForm={!patIsValid || Boolean(location.query.resetPat)}\n        submittingToken={submittingToken}\n        tokenValidationFailed={tokenValidationFailed}\n      />\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport { translate, translateWithParameters } from 'sonar-ui-common/helpers/l10n';\nimport { getBaseUrl } from 'sonar-ui-common/helpers/urls';\nimport DocumentationTooltip from '../../../components/common/DocumentationTooltip';\nimport { withAppState } from '../../../components/hoc/withAppState';\nimport { ALM_DOCUMENTATION_PATHS } from '../../../helpers/constants';\nimport { AlmKeys } from '../../../types/alm-settings';\nimport { ALM_INTEGRATION } from '../../settings/components/AdditionalCategoryKeys';\nimport { CreateProjectModes } from './types';\n\nexport interface CreateProjectModeSelectionProps {\n  almCounts: {\n    [AlmKeys.Azure]: number;\n    [AlmKeys.BitbucketServer]: number;\n    [AlmKeys.GitLab]: number;\n    [AlmKeys.GitHub]: number;\n  };\n  appState: Pick<T.AppState, 'canAdmin'>;\n  loadingBindings: boolean;\n  onSelectMode: (mode: CreateProjectModes) => void;\n}\n\nfunction renderAlmOption(\n  props: CreateProjectModeSelectionProps,\n  alm: AlmKeys.Azure | AlmKeys.BitbucketServer | AlmKeys.GitHub | AlmKeys.GitLab,\n  mode: CreateProjectModes\n) {\n  const {\n    almCounts,\n    appState: { canAdmin },\n    loadingBindings\n  } = props;\n\n  const count = almCounts[alm];\n  const disabled = count !== 1 || loadingBindings;\n\n  const tooltipLinks = [];\n  if (count === 0) {\n    if (canAdmin) {\n      tooltipLinks.push({\n        href: `/admin/settings?category=${ALM_INTEGRATION}&alm=${alm}`,\n        label: translateWithParameters(\n          'onboarding.create_project.set_up_x',\n          translate('alm', alm, 'short')\n        )\n      });\n    }\n\n    tooltipLinks.push({\n      href: ALM_DOCUMENTATION_PATHS[alm],\n      label: translateWithParameters(\n        'onboarding.create_project.help_set_up_x',\n        translate('alm', alm, 'short')\n      )\n    });\n  }\n\n  return (\n    <div className=\"big-spacer-left display-flex-column\">\n      <button\n        className={classNames(\n          'button button-huge display-flex-column create-project-mode-type-alm',\n          { disabled }\n        )}\n        disabled={disabled}\n        onClick={() => props.onSelectMode(mode)}\n        type=\"button\">\n        <img\n          alt=\"\" // Should be ignored by screen readers\n          height={80}\n          src={`${getBaseUrl()}/images/alm/${alm}.svg`}\n        />\n        <div className=\"medium big-spacer-top abs-height-50 display-flex-center\">\n          {translate('onboarding.create_project.select_method', alm)}\n        </div>\n\n        {loadingBindings && (\n          <span>\n            {translate('onboarding.create_project.check_alm_supported')}\n            <i className=\"little-spacer-left spinner\" />\n          </span>\n        )}\n\n        {!loadingBindings && disabled && (\n          <div className=\"text-muted small spacer-top\" style={{ lineHeight: 1.5 }}>\n            {translate('onboarding.create_project.alm_not_configured')}\n            <DocumentationTooltip\n              className=\"little-spacer-left\"\n              content={\n                count === 0\n                  ? translate('onboarding.create_project.zero_alm_instances', alm)\n                  : `${translate('onboarding.create_project.too_many_alm_instances', alm)} \n                ${translateWithParameters(\n                  'onboarding.create_project.alm_instances_count_X',\n                  count\n                )}`\n              }\n              links={count === 0 ? tooltipLinks : undefined}\n            />\n          </div>\n        )}\n      </button>\n    </div>\n  );\n}\n\nexport function CreateProjectModeSelection(props: CreateProjectModeSelectionProps) {\n  return (\n    <>\n      <header className=\"huge-spacer-top big-spacer-bottom padded\">\n        <h1 className=\"text-center huge big-spacer-bottom\">\n          {translate('my_account.create_new.TRK')}\n        </h1>\n        <p className=\"text-center big\">{translate('onboarding.create_project.select_method')}</p>\n      </header>\n\n      <div className=\"create-project-modes huge-spacer-top display-flex-justify-center\">\n        <button\n          className=\"button button-huge display-flex-column create-project-mode-type-manual\"\n          onClick={() => props.onSelectMode(CreateProjectModes.Manual)}\n          type=\"button\">\n          <img\n            alt=\"\" // Should be ignored by screen readers\n            height={80}\n            src={`${getBaseUrl()}/images/sonarcloud/analysis/manual.svg`}\n          />\n          <div className=\"medium big-spacer-top\">\n            {translate('onboarding.create_project.select_method.manual')}\n          </div>\n        </button>\n\n        {renderAlmOption(props, AlmKeys.Azure, CreateProjectModes.AzureDevOps)}\n        {renderAlmOption(props, AlmKeys.BitbucketServer, CreateProjectModes.BitbucketServer)}\n        {renderAlmOption(props, AlmKeys.GitHub, CreateProjectModes.GitHub)}\n        {renderAlmOption(props, AlmKeys.GitLab, CreateProjectModes.GitLab)}\n      </div>\n    </>\n  );\n}\n\nexport default withAppState(CreateProjectModeSelection);\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { Link } from 'react-router';\nimport { Button } from 'sonar-ui-common/components/controls/buttons';\nimport ListFooter from 'sonar-ui-common/components/controls/ListFooter';\nimport Radio from 'sonar-ui-common/components/controls/Radio';\nimport SearchBox from 'sonar-ui-common/components/controls/SearchBox';\nimport SearchSelect from 'sonar-ui-common/components/controls/SearchSelect';\nimport CheckIcon from 'sonar-ui-common/components/icons/CheckIcon';\nimport { Alert } from 'sonar-ui-common/components/ui/Alert';\nimport DeferredSpinner from 'sonar-ui-common/components/ui/DeferredSpinner';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { getBaseUrl } from '../../../helpers/system';\nimport { GithubOrganization, GithubRepository } from '../../../types/alm-integration';\nimport CreateProjectPageHeader from './CreateProjectPageHeader';\n\nexport interface GitHubProjectCreateRendererProps {\n  canAdmin: boolean;\n  error: boolean;\n  importing: boolean;\n  loadingBindings: boolean;\n  loadingOrganizations: boolean;\n  loadingRepositories: boolean;\n  onImportRepository: () => void;\n  onLoadMore: () => void;\n  onSearch: (q: string) => void;\n  onSelectOrganization: (key: string) => void;\n  onSelectRepository: (key: string) => void;\n  organizations: GithubOrganization[];\n  repositories?: GithubRepository[];\n  repositoryPaging: T.Paging;\n  searchQuery: string;\n  selectedOrganization?: GithubOrganization;\n  selectedRepository?: GithubRepository;\n}\n\nfunction orgToOption({ key, name }: GithubOrganization) {\n  return { value: key, label: name };\n}\n\nconst handleSearch = (organizations: GithubOrganization[]) => (q: string) =>\n  Promise.resolve(organizations.filter(o => !q || o.name.includes(q)).map(orgToOption));\n\nfunction renderRepositoryList(props: GitHubProjectCreateRendererProps) {\n  const {\n    importing,\n    loadingRepositories,\n    repositories,\n    repositoryPaging,\n    searchQuery,\n    selectedOrganization,\n    selectedRepository\n  } = props;\n\n  const isChecked = (repository: GithubRepository) =>\n    !!repository.sqProjectKey ||\n    (!!selectedRepository && selectedRepository.key === repository.key);\n\n  const isDisabled = (repository: GithubRepository) =>\n    !!repository.sqProjectKey || loadingRepositories || importing;\n\n  return (\n    selectedOrganization &&\n    repositories && (\n      <div className=\"boxed-group padded display-flex-wrap\">\n        <div className=\"width-100\">\n          <SearchBox\n            className=\"big-spacer-bottom\"\n            onChange={props.onSearch}\n            placeholder={translate('onboarding.create_project.search_repositories')}\n            value={searchQuery}\n          />\n        </div>\n\n        {repositories.length === 0 ? (\n          <div className=\"padded\">\n            <DeferredSpinner loading={loadingRepositories}>\n              {translate('no_results')}\n            </DeferredSpinner>\n          </div>\n        ) : (\n          repositories.map(r => (\n            <Radio\n              className=\"spacer-top spacer-bottom padded create-project-github-repository\"\n              key={r.key}\n              checked={isChecked(r)}\n              disabled={isDisabled(r)}\n              value={r.key}\n              onCheck={props.onSelectRepository}>\n              <div className=\"big overflow-hidden\" title={r.name}>\n                <div className=\"text-ellipsis\">{r.name}</div>\n                {r.sqProjectKey && (\n                  <em className=\"notice text-muted-2 small display-flex-center\">\n                    {translate('onboarding.create_project.repository_imported')}\n                    <CheckIcon className=\"little-spacer-left\" size={12} />\n                  </em>\n                )}\n              </div>\n            </Radio>\n          ))\n        )}\n\n        <div className=\"display-flex-justify-center width-100\">\n          <ListFooter\n            count={repositories.length}\n            total={repositoryPaging.total}\n            loadMore={props.onLoadMore}\n            loading={loadingRepositories}\n          />\n        </div>\n      </div>\n    )\n  );\n}\n\nexport default function GitHubProjectCreateRenderer(props: GitHubProjectCreateRendererProps) {\n  const {\n    canAdmin,\n    error,\n    importing,\n    loadingBindings,\n    loadingOrganizations,\n    organizations,\n    selectedOrganization,\n    selectedRepository\n  } = props;\n\n  if (loadingBindings) {\n    return <DeferredSpinner />;\n  }\n\n  return (\n    <div>\n      <CreateProjectPageHeader\n        additionalActions={\n          selectedOrganization && (\n            <div className=\"display-flex-center pull-right\">\n              <DeferredSpinner className=\"spacer-right\" loading={importing} />\n              <Button\n                className=\"button-large button-primary\"\n                disabled={!selectedRepository || importing}\n                onClick={props.onImportRepository}>\n                {translate('onboarding.create_project.import_selected_repo')}\n              </Button>\n            </div>\n          )\n        }\n        title={\n          <span className=\"text-middle display-flex-center\">\n            <img\n              alt=\"\" // Should be ignored by screen readers\n              className=\"spacer-right\"\n              height={24}\n              src={`${getBaseUrl()}/images/alm/github.svg`}\n            />\n            {translate('onboarding.create_project.github.title')}\n          </span>\n        }\n      />\n\n      {error ? (\n        <div className=\"display-flex-justify-center\">\n          <div className=\"boxed-group padded width-50 huge-spacer-top\">\n            <h2 className=\"big-spacer-bottom\">\n              {translate('onboarding.create_project.github.warning.title')}\n            </h2>\n            <Alert variant=\"warning\">\n              {canAdmin ? (\n                <FormattedMessage\n                  id=\"onboarding.create_project.github.warning.message_admin\"\n                  defaultMessage={translate(\n                    'onboarding.create_project.github.warning.message_admin'\n                  )}\n                  values={{\n                    link: (\n                      <Link to=\"/admin/settings?category=almintegration\">\n                        {translate('onboarding.create_project.github.warning.message_admin.link')}\n                      </Link>\n                    )\n                  }}\n                />\n              ) : (\n                translate('onboarding.create_project.github.warning.message')\n              )}\n            </Alert>\n          </div>\n        </div>\n      ) : (\n        <DeferredSpinner loading={loadingOrganizations}>\n          <div className=\"form-field\">\n            <label>{translate('onboarding.create_project.github.choose_organization')}</label>\n            {organizations.length > 0 ? (\n              <SearchSelect\n                defaultOptions={organizations.map(orgToOption)}\n                onSearch={handleSearch(organizations)}\n                minimumQueryLength={0}\n                onSelect={({ value }) => props.onSelectOrganization(value)}\n                value={selectedOrganization && orgToOption(selectedOrganization)}\n              />\n            ) : (\n              !loadingOrganizations && (\n                <Alert className=\"spacer-top\" variant=\"error\">\n                  {canAdmin ? (\n                    <FormattedMessage\n                      id=\"onboarding.create_project.github.no_orgs_admin\"\n                      defaultMessage={translate('onboarding.create_project.github.no_orgs_admin')}\n                      values={{\n                        link: (\n                          <Link to=\"/admin/settings?category=almintegration\">\n                            {translate(\n                              'onboarding.create_project.github.warning.message_admin.link'\n                            )}\n                          </Link>\n                        )\n                      }}\n                    />\n                  ) : (\n                    translate('onboarding.create_project.github.no_orgs')\n                  )}\n                </Alert>\n              )\n            )}\n          </div>\n        </DeferredSpinner>\n      )}\n\n      {renderRepositoryList(props)}\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { debounce } from 'lodash';\nimport * as React from 'react';\nimport { WithRouterProps } from 'react-router';\nimport { getHostUrl } from 'sonar-ui-common/helpers/urls';\nimport {\n  getGithubClientId,\n  getGithubOrganizations,\n  getGithubRepositories,\n  importGithubRepository\n} from '../../../api/alm-integrations';\nimport { GithubOrganization, GithubRepository } from '../../../types/alm-integration';\nimport { AlmKeys, AlmSettingsInstance } from '../../../types/alm-settings';\nimport GitHubProjectCreateRenderer from './GitHubProjectCreateRenderer';\n\ninterface Props extends Pick<WithRouterProps, 'location' | 'router'> {\n  canAdmin: boolean;\n  loadingBindings: boolean;\n  onProjectCreate: (projectKeys: string[]) => void;\n  settings: AlmSettingsInstance[];\n}\n\ninterface State {\n  error: boolean;\n  importing: boolean;\n  loadingOrganizations: boolean;\n  loadingRepositories: boolean;\n  organizations: GithubOrganization[];\n  repositoryPaging: T.Paging;\n  repositories: GithubRepository[];\n  searchQuery: string;\n  selectedOrganization?: GithubOrganization;\n  selectedRepository?: GithubRepository;\n  settings?: AlmSettingsInstance;\n}\n\nconst REPOSITORY_PAGE_SIZE = 30;\n\nexport default class GitHubProjectCreate extends React.Component<Props, State> {\n  mounted = false;\n\n  constructor(props: Props) {\n    super(props);\n\n    this.state = {\n      error: false,\n      importing: false,\n      loadingOrganizations: true,\n      loadingRepositories: false,\n      organizations: [],\n      repositories: [],\n      repositoryPaging: { pageSize: REPOSITORY_PAGE_SIZE, total: 0, pageIndex: 1 },\n      searchQuery: '',\n      settings: props.settings[0]\n    };\n\n    this.triggerSearch = debounce(this.triggerSearch, 250);\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n\n    this.initialize();\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (prevProps.settings.length === 0 && this.props.settings.length > 0) {\n      this.setState({ settings: this.props.settings[0] }, () => this.initialize());\n    }\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  async initialize() {\n    const { location, router } = this.props;\n    const { settings } = this.state;\n\n    if (!settings || !settings.url) {\n      this.setState({ error: true });\n      return;\n    } else {\n      this.setState({ error: false });\n    }\n\n    const code = location.query?.code;\n\n    try {\n      if (!code) {\n        await this.redirectToGithub(settings);\n      } else {\n        delete location.query.code;\n        router.replace(location);\n        await this.fetchOrganizations(settings, code);\n      }\n    } catch (e) {\n      if (this.mounted) {\n        this.setState({ error: true });\n      }\n    }\n  }\n\n  async redirectToGithub(settings: AlmSettingsInstance) {\n    if (!settings.url) {\n      return;\n    }\n\n    const { clientId } = await getGithubClientId(settings.key);\n\n    if (!clientId) {\n      this.setState({ error: true });\n      return;\n    }\n\n    const queryParams = [\n      { param: 'client_id', value: clientId },\n      { param: 'redirect_uri', value: `${getHostUrl()}/projects/create?mode=${AlmKeys.GitHub}` }\n    ]\n      .map(({ param, value }) => `${param}=${value}`)\n      .join('&');\n\n    let instanceRootUrl;\n    // Strip the api section from the url, since we're not hitting the api here.\n    if (settings.url.includes('/api/v3')) {\n      // GitHub Enterprise\n      instanceRootUrl = settings.url.replace('/api/v3', '');\n    } else {\n      // github.com\n      instanceRootUrl = settings.url.replace('api.', '');\n    }\n\n    // strip the trailing /\n    instanceRootUrl = instanceRootUrl.replace(/\\/$/, '');\n    window.location.replace(`${instanceRootUrl}/login/oauth/authorize?${queryParams}`);\n  }\n\n  async fetchOrganizations(settings: AlmSettingsInstance, token: string) {\n    const { organizations } = await getGithubOrganizations(settings.key, token);\n\n    if (this.mounted) {\n      this.setState({ loadingOrganizations: false, organizations });\n    }\n  }\n\n  async fetchRepositories(params: { organizationKey: string; page?: number; query?: string }) {\n    const { organizationKey, page = 1, query } = params;\n    const { settings } = this.state;\n\n    if (!settings) {\n      this.setState({ error: true });\n      return;\n    }\n\n    this.setState({ loadingRepositories: true });\n\n    try {\n      const data = await getGithubRepositories({\n        almSetting: settings.key,\n        organization: organizationKey,\n        pageSize: REPOSITORY_PAGE_SIZE,\n        page,\n        query\n      });\n\n      if (this.mounted) {\n        this.setState(({ repositories }) => ({\n          loadingRepositories: false,\n          repositoryPaging: data.paging,\n          repositories: page === 1 ? data.repositories : [...repositories, ...data.repositories]\n        }));\n      }\n    } catch (_) {\n      if (this.mounted) {\n        this.setState({\n          loadingRepositories: false,\n          repositoryPaging: { pageIndex: 1, pageSize: REPOSITORY_PAGE_SIZE, total: 0 },\n          repositories: []\n        });\n      }\n    }\n  }\n\n  triggerSearch = (query: string) => {\n    const { selectedOrganization } = this.state;\n    if (selectedOrganization) {\n      this.setState({ selectedRepository: undefined });\n      this.fetchRepositories({ organizationKey: selectedOrganization.key, query });\n    }\n  };\n\n  handleSelectOrganization = (key: string) => {\n    this.setState(({ organizations }) => ({\n      searchQuery: '',\n      selectedRepository: undefined,\n      selectedOrganization: organizations.find(o => o.key === key)\n    }));\n    this.fetchRepositories({ organizationKey: key });\n  };\n\n  handleSelectRepository = (key: string) => {\n    this.setState(({ repositories }) => ({\n      selectedRepository: repositories?.find(r => r.key === key)\n    }));\n  };\n\n  handleSearch = (searchQuery: string) => {\n    this.setState({ searchQuery });\n    this.triggerSearch(searchQuery);\n  };\n\n  handleLoadMore = () => {\n    const { repositoryPaging, searchQuery, selectedOrganization } = this.state;\n\n    if (selectedOrganization) {\n      this.fetchRepositories({\n        organizationKey: selectedOrganization.key,\n        page: repositoryPaging.pageIndex + 1,\n        query: searchQuery\n      });\n    }\n  };\n\n  handleImportRepository = async () => {\n    const { selectedOrganization, selectedRepository, settings } = this.state;\n\n    if (settings && selectedOrganization && selectedRepository) {\n      this.setState({ importing: true });\n\n      try {\n        const { project } = await importGithubRepository(\n          settings.key,\n          selectedOrganization.key,\n          selectedRepository.key\n        );\n\n        this.props.onProjectCreate([project.key]);\n      } finally {\n        if (this.mounted) {\n          this.setState({ importing: false });\n        }\n      }\n    }\n  };\n\n  render() {\n    const { canAdmin, loadingBindings } = this.props;\n    const {\n      error,\n      importing,\n      loadingOrganizations,\n      loadingRepositories,\n      organizations,\n      repositoryPaging,\n      repositories,\n      searchQuery,\n      selectedOrganization,\n      selectedRepository\n    } = this.state;\n\n    return (\n      <GitHubProjectCreateRenderer\n        canAdmin={canAdmin}\n        error={error}\n        importing={importing}\n        loadingBindings={loadingBindings}\n        loadingOrganizations={loadingOrganizations}\n        loadingRepositories={loadingRepositories}\n        onImportRepository={this.handleImportRepository}\n        onLoadMore={this.handleLoadMore}\n        onSearch={this.handleSearch}\n        onSelectOrganization={this.handleSelectOrganization}\n        onSelectRepository={this.handleSelectRepository}\n        organizations={organizations}\n        repositoryPaging={repositoryPaging}\n        searchQuery={searchQuery}\n        repositories={repositories}\n        selectedOrganization={selectedOrganization}\n        selectedRepository={selectedRepository}\n      />\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport classNames from 'classnames';\nimport * as React from 'react';\nimport { Button } from 'sonar-ui-common/components/controls/buttons';\nimport DeferredSpinner from 'sonar-ui-common/components/ui/DeferredSpinner';\nimport { translate, translateWithParameters } from 'sonar-ui-common/helpers/l10n';\nimport { formatMeasure } from 'sonar-ui-common/helpers/measures';\n\nexport interface ListFooterProps {\n  count: number;\n  className?: string;\n  loading?: boolean;\n  loadMore?: () => void;\n  needReload?: boolean;\n  pageSize?: number;\n  reload?: () => void;\n  ready?: boolean;\n  total?: number;\n}\n\nexport default function ListFooter(props: ListFooterProps) {\n  const { className, count, loading, needReload, total, pageSize, ready = true } = props;\n\n  let hasMore = false;\n  if (total !== undefined) {\n    hasMore = total > count;\n  } else if (pageSize !== undefined) {\n    hasMore = count % pageSize === 0;\n  }\n\n  let button;\n  if (needReload && props.reload) {\n    button = (\n      <Button className=\"spacer-left\" data-test=\"reload\" disabled={loading} onClick={props.reload}>\n        {translate('reload')}\n      </Button>\n    );\n  } else if (hasMore && props.loadMore) {\n    button = (\n      <Button\n        className=\"spacer-left\"\n        disabled={loading}\n        data-test=\"show-more\"\n        onClick={props.loadMore}>\n        {translate('show_more')}\n      </Button>\n    );\n  }\n\n  return (\n    <footer\n      className={classNames('spacer-top note text-center', { 'new-loading': !ready }, className)}>\n      {total !== undefined\n        ? translateWithParameters(\n            'x_of_y_shown',\n            formatMeasure(count, 'INT', null),\n            formatMeasure(total, 'INT', null)\n          )\n        : translateWithParameters('x_show', formatMeasure(count, 'INT', null))}\n      {button}\n      {loading && <DeferredSpinner className=\"text-bottom spacer-left position-absolute\" />}\n    </footer>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { Link } from 'react-router';\nimport { Button } from 'sonar-ui-common/components/controls/buttons';\nimport SearchBox from 'sonar-ui-common/components/controls/SearchBox';\nimport Tooltip from 'sonar-ui-common/components/controls/Tooltip';\nimport CheckIcon from 'sonar-ui-common/components/icons/CheckIcon';\nimport DetachIcon from 'sonar-ui-common/components/icons/DetachIcon';\nimport QualifierIcon from 'sonar-ui-common/components/icons/QualifierIcon';\nimport { Alert } from 'sonar-ui-common/components/ui/Alert';\nimport DeferredSpinner from 'sonar-ui-common/components/ui/DeferredSpinner';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport ListFooter from '../../../components/controls/ListFooter';\nimport { getProjectUrl } from '../../../helpers/urls';\nimport { GitlabProject } from '../../../types/alm-integration';\nimport { ComponentQualifier } from '../../../types/component';\nimport { CreateProjectModes } from './types';\n\nexport interface GitlabProjectSelectionFormProps {\n  importingGitlabProjectId?: string;\n  loadingMore: boolean;\n  onImport: (gitlabProjectId: string) => void;\n  onLoadMore: () => void;\n  onSearch: (searchQuery: string) => void;\n  projects?: GitlabProject[];\n  projectsPaging: T.Paging;\n  searching: boolean;\n  searchQuery: string;\n}\n\nexport default function GitlabProjectSelectionForm(props: GitlabProjectSelectionFormProps) {\n  const {\n    importingGitlabProjectId,\n    loadingMore,\n    projects = [],\n    projectsPaging,\n    searching,\n    searchQuery\n  } = props;\n\n  if (projects.length === 0 && searchQuery.length === 0 && !searching) {\n    return (\n      <Alert className=\"spacer-top\" variant=\"warning\">\n        <FormattedMessage\n          defaultMessage={translate('onboarding.create_project.gitlab.no_projects')}\n          id=\"onboarding.create_project.gitlab.no_projects\"\n          values={{\n            link: (\n              <Link\n                to={{\n                  pathname: '/projects/create',\n                  query: { mode: CreateProjectModes.GitLab, resetPat: 1 }\n                }}>\n                {translate('onboarding.create_project.update_your_token')}\n              </Link>\n            )\n          }}\n        />\n      </Alert>\n    );\n  }\n\n  return (\n    <div className=\"boxed-group big-padded create-project-import-gitlab\">\n      <SearchBox\n        className=\"spacer\"\n        loading={searching}\n        minLength={3}\n        onChange={props.onSearch}\n        placeholder={translate('onboarding.create_project.gitlab.search_prompt')}\n      />\n\n      <hr />\n\n      {projects.length === 0 ? (\n        <div className=\"padded\">{translate('no_results')}</div>\n      ) : (\n        <table className=\"data zebra zebra-hover\">\n          <tbody>\n            {projects.map(project => (\n              <tr key={project.id}>\n                <td>\n                  <Tooltip overlay={project.slug}>\n                    <strong className=\"project-name display-inline-block text-ellipsis\">\n                      {project.sqProjectKey ? (\n                        <Link to={getProjectUrl(project.sqProjectKey)}>\n                          <QualifierIcon\n                            className=\"spacer-right\"\n                            qualifier={ComponentQualifier.Project}\n                          />\n                          {project.sqProjectName}\n                        </Link>\n                      ) : (\n                        project.name\n                      )}\n                    </strong>\n                  </Tooltip>\n                  <br />\n                  <Tooltip overlay={project.pathSlug}>\n                    <span className=\"text-muted project-path display-inline-block text-ellipsis\">\n                      {project.pathName}\n                    </span>\n                  </Tooltip>\n                </td>\n                <td>\n                  <a\n                    className=\"display-inline-flex-center big-spacer-right\"\n                    href={project.url}\n                    rel=\"noopener noreferrer\"\n                    target=\"_blank\">\n                    <DetachIcon className=\"little-spacer-right\" />\n                    {translate('onboarding.create_project.gitlab.link')}\n                  </a>\n                </td>\n                {project.sqProjectKey ? (\n                  <td>\n                    <span className=\"display-flex-center display-flex-justify-end already-set-up\">\n                      <CheckIcon className=\"little-spacer-right\" size={12} />\n                      {translate('onboarding.create_project.repository_imported')}\n                    </span>\n                  </td>\n                ) : (\n                  <td className=\"text-right\">\n                    <Button\n                      disabled={!!importingGitlabProjectId}\n                      onClick={() => props.onImport(project.id)}>\n                      {translate('onboarding.create_project.gitlab.set_up')}\n                      {importingGitlabProjectId === project.id && (\n                        <DeferredSpinner className=\"spacer-left\" />\n                      )}\n                    </Button>\n                  </td>\n                )}\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      )}\n      <ListFooter\n        count={projects.length}\n        loadMore={props.onLoadMore}\n        loading={loadingMore}\n        pageSize={projectsPaging.pageSize}\n        total={projectsPaging.total}\n      />\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { getBaseUrl } from 'sonar-ui-common/helpers/urls';\nimport { GitlabProject } from '../../../types/alm-integration';\nimport { AlmKeys, AlmSettingsInstance } from '../../../types/alm-settings';\nimport CreateProjectPageHeader from './CreateProjectPageHeader';\nimport GitlabProjectSelectionForm from './GitlabProjectSelectionForm';\nimport PersonalAccessTokenForm from './PersonalAccessTokenForm';\nimport WrongBindingCountAlert from './WrongBindingCountAlert';\n\nexport interface GitlabProjectCreateRendererProps {\n  canAdmin?: boolean;\n  importingGitlabProjectId?: string;\n  loading: boolean;\n  loadingMore: boolean;\n  onImport: (gitlabProjectId: string) => void;\n  onLoadMore: () => void;\n  onPersonalAccessTokenCreate: (pat: string) => void;\n  onSearch: (searchQuery: string) => void;\n  projects?: GitlabProject[];\n  projectsPaging: T.Paging;\n  searching: boolean;\n  searchQuery: string;\n  settings?: AlmSettingsInstance;\n  showPersonalAccessTokenForm?: boolean;\n  submittingToken?: boolean;\n  tokenValidationErrorMessage?: string;\n}\n\nexport default function GitlabProjectCreateRenderer(props: GitlabProjectCreateRendererProps) {\n  const {\n    canAdmin,\n    importingGitlabProjectId,\n    loading,\n    loadingMore,\n    projects,\n    projectsPaging,\n    searching,\n    searchQuery,\n    settings,\n    showPersonalAccessTokenForm,\n    submittingToken,\n    tokenValidationErrorMessage\n  } = props;\n\n  return (\n    <>\n      <CreateProjectPageHeader\n        title={\n          <span className=\"text-middle\">\n            <img\n              alt=\"\" // Should be ignored by screen readers\n              className=\"spacer-right\"\n              height=\"24\"\n              src={`${getBaseUrl()}/images/alm/gitlab.svg`}\n            />\n            {translate('onboarding.create_project.gitlab.title')}\n          </span>\n        }\n      />\n\n      {loading && <i className=\"spinner\" />}\n\n      {!loading && !settings && (\n        <WrongBindingCountAlert alm={AlmKeys.GitLab} canAdmin={!!canAdmin} />\n      )}\n\n      {!loading &&\n        settings &&\n        (showPersonalAccessTokenForm ? (\n          <PersonalAccessTokenForm\n            almSetting={settings}\n            onPersonalAccessTokenCreate={props.onPersonalAccessTokenCreate}\n            submitting={submittingToken}\n            validationFailed={Boolean(tokenValidationErrorMessage)}\n            validationErrorMessage={tokenValidationErrorMessage}\n          />\n        ) : (\n          <GitlabProjectSelectionForm\n            importingGitlabProjectId={importingGitlabProjectId}\n            loadingMore={loadingMore}\n            onImport={props.onImport}\n            onLoadMore={props.onLoadMore}\n            onSearch={props.onSearch}\n            projects={projects}\n            projectsPaging={projectsPaging}\n            searching={searching}\n            searchQuery={searchQuery}\n          />\n        ))}\n    </>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { WithRouterProps } from 'react-router';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport {\n  checkPersonalAccessTokenIsValid,\n  getGitlabProjects,\n  importGitlabProject,\n  setAlmPersonalAccessToken\n} from '../../../api/alm-integrations';\nimport { GitlabProject } from '../../../types/alm-integration';\nimport { AlmKeys, AlmSettingsInstance } from '../../../types/alm-settings';\nimport GitlabProjectCreateRenderer from './GitlabProjectCreateRenderer';\n\ninterface Props extends Pick<WithRouterProps, 'location' | 'router'> {\n  canAdmin: boolean;\n  loadingBindings: boolean;\n  onProjectCreate: (projectKeys: string[]) => void;\n  settings: AlmSettingsInstance[];\n}\n\ninterface State {\n  importingGitlabProjectId?: string;\n  loading: boolean;\n  loadingMore: boolean;\n  projects?: GitlabProject[];\n  projectsPaging: T.Paging;\n  submittingToken: boolean;\n  tokenIsValid: boolean;\n  tokenValidationErrorMessage?: string;\n  searching: boolean;\n  searchQuery: string;\n  settings?: AlmSettingsInstance;\n}\n\nconst GITLAB_PROJECTS_PAGESIZE = 30;\n\nexport default class GitlabProjectCreate extends React.PureComponent<Props, State> {\n  mounted = false;\n\n  constructor(props: Props) {\n    super(props);\n\n    this.state = {\n      loading: false,\n      loadingMore: false,\n      projectsPaging: { pageIndex: 1, total: 0, pageSize: GITLAB_PROJECTS_PAGESIZE },\n      tokenIsValid: false,\n      searching: false,\n      searchQuery: '',\n      settings: props.settings.length === 1 ? props.settings[0] : undefined,\n      submittingToken: false\n    };\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n    this.fetchInitialData();\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (prevProps.settings.length === 0 && this.props.settings.length > 0) {\n      this.setState(\n        { settings: this.props.settings.length === 1 ? this.props.settings[0] : undefined },\n        () => this.fetchInitialData()\n      );\n    }\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  fetchInitialData = async () => {\n    this.setState({ loading: true });\n\n    const { status, error } = await this.checkPersonalAccessToken();\n\n    let result;\n    if (status) {\n      result = await this.fetchProjects();\n    }\n\n    if (this.mounted) {\n      if (result) {\n        const { projects, projectsPaging } = result;\n\n        this.setState({\n          tokenIsValid: status,\n          loading: false,\n          projects,\n          projectsPaging\n        });\n      } else {\n        this.setState({\n          loading: false,\n          tokenValidationErrorMessage: !status ? error : undefined\n        });\n      }\n    }\n  };\n\n  checkPersonalAccessToken = () => {\n    const { settings } = this.state;\n\n    if (!settings) {\n      return Promise.resolve({\n        status: false,\n        error: translate('onboarding.create_project.pat_incorrect', AlmKeys.GitLab)\n      });\n    }\n\n    return checkPersonalAccessTokenIsValid(settings.key);\n  };\n\n  handleError = () => {\n    if (this.mounted) {\n      this.setState({ tokenIsValid: false });\n    }\n\n    return undefined;\n  };\n\n  fetchProjects = async (pageIndex = 1, query?: string) => {\n    const { settings } = this.state;\n\n    if (!settings) {\n      return Promise.resolve(undefined);\n    }\n\n    try {\n      return await getGitlabProjects({\n        almSetting: settings.key,\n        page: pageIndex,\n        pageSize: GITLAB_PROJECTS_PAGESIZE,\n        query\n      });\n    } catch (_) {\n      return this.handleError();\n    }\n  };\n\n  doImport = async (gitlabProjectId: string) => {\n    const { settings } = this.state;\n\n    if (!settings) {\n      return Promise.resolve(undefined);\n    }\n\n    try {\n      return await importGitlabProject({\n        almSetting: settings.key,\n        gitlabProjectId\n      });\n    } catch (_) {\n      return this.handleError();\n    }\n  };\n\n  handleImport = async (gitlabProjectId: string) => {\n    this.setState({ importingGitlabProjectId: gitlabProjectId });\n\n    const result = await this.doImport(gitlabProjectId);\n\n    if (this.mounted) {\n      this.setState({ importingGitlabProjectId: undefined });\n\n      if (result) {\n        this.props.onProjectCreate([result.project.key]);\n      }\n    }\n  };\n\n  handleLoadMore = async () => {\n    this.setState({ loadingMore: true });\n\n    const {\n      projectsPaging: { pageIndex },\n      searchQuery\n    } = this.state;\n\n    const result = await this.fetchProjects(pageIndex + 1, searchQuery);\n\n    if (this.mounted) {\n      this.setState(({ projects = [], projectsPaging }) => ({\n        loadingMore: false,\n        projects: result ? [...projects, ...result.projects] : projects,\n        projectsPaging: result ? result.projectsPaging : projectsPaging\n      }));\n    }\n  };\n\n  handleSearch = async (searchQuery: string) => {\n    this.setState({ searching: true, searchQuery });\n\n    const result = await this.fetchProjects(1, searchQuery);\n\n    if (this.mounted) {\n      this.setState(({ projects, projectsPaging }) => ({\n        searching: false,\n        projects: result ? result.projects : projects,\n        projectsPaging: result ? result.projectsPaging : projectsPaging\n      }));\n    }\n  };\n\n  cleanUrl = () => {\n    const { location, router } = this.props;\n    delete location.query.resetPat;\n    router.replace(location);\n  };\n\n  handlePersonalAccessTokenCreate = async (token: string) => {\n    const { settings } = this.state;\n\n    if (!settings || token.length < 1) {\n      return;\n    }\n\n    this.setState({ submittingToken: true, tokenValidationErrorMessage: undefined });\n\n    try {\n      await setAlmPersonalAccessToken(settings.key, token);\n\n      const { status, error } = await this.checkPersonalAccessToken();\n\n      if (this.mounted) {\n        this.setState({\n          submittingToken: false,\n          tokenIsValid: status,\n          tokenValidationErrorMessage: error\n        });\n\n        if (status) {\n          this.cleanUrl();\n          await this.fetchInitialData();\n        }\n      }\n    } catch (e) {\n      if (this.mounted) {\n        this.setState({ submittingToken: false });\n      }\n    }\n  };\n\n  render() {\n    const { canAdmin, loadingBindings, location } = this.props;\n    const {\n      importingGitlabProjectId,\n      loading,\n      loadingMore,\n      projects,\n      projectsPaging,\n      tokenIsValid,\n      searching,\n      searchQuery,\n      settings,\n      submittingToken,\n      tokenValidationErrorMessage\n    } = this.state;\n\n    return (\n      <GitlabProjectCreateRenderer\n        settings={settings}\n        canAdmin={canAdmin}\n        importingGitlabProjectId={importingGitlabProjectId}\n        loading={loading || loadingBindings}\n        loadingMore={loadingMore}\n        onImport={this.handleImport}\n        onLoadMore={this.handleLoadMore}\n        onPersonalAccessTokenCreate={this.handlePersonalAccessTokenCreate}\n        onSearch={this.handleSearch}\n        projects={projects}\n        projectsPaging={projectsPaging}\n        searching={searching}\n        searchQuery={searchQuery}\n        showPersonalAccessTokenForm={!tokenIsValid || Boolean(location.query.resetPat)}\n        submittingToken={submittingToken}\n        tokenValidationErrorMessage={tokenValidationErrorMessage}\n      />\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport { debounce } from 'lodash';\nimport * as React from 'react';\nimport { SubmitButton } from 'sonar-ui-common/components/controls/buttons';\nimport ValidationInput from 'sonar-ui-common/components/controls/ValidationInput';\nimport DeferredSpinner from 'sonar-ui-common/components/ui/DeferredSpinner';\nimport MandatoryFieldsExplanation from 'sonar-ui-common/components/ui/MandatoryFieldsExplanation';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { createProject, doesComponentExists } from '../../../api/components';\nimport ProjectKeyInput from '../../../components/common/ProjectKeyInput';\nimport { validateProjectKey } from '../../../helpers/projects';\nimport { ProjectKeyValidationResult } from '../../../types/component';\nimport { PROJECT_NAME_MAX_LEN } from './constants';\nimport CreateProjectPageHeader from './CreateProjectPageHeader';\nimport './ManualProjectCreate.css';\n\ninterface Props {\n  onProjectCreate: (projectKeys: string[]) => void;\n}\n\ninterface State {\n  projectName: string;\n  projectNameChanged: boolean;\n  projectNameError?: string;\n  projectKey: string;\n  projectKeyError?: string;\n  submitting: boolean;\n  touched: boolean;\n  validating: boolean;\n}\n\ntype ValidState = State & Required<Pick<State, 'projectKey' | 'projectName'>>;\n\nexport default class ManualProjectCreate extends React.PureComponent<Props, State> {\n  mounted = false;\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      projectKey: '',\n      projectName: '',\n      projectNameChanged: false,\n      submitting: false,\n      touched: false,\n      validating: false\n    };\n    this.checkFreeKey = debounce(this.checkFreeKey, 250);\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  checkFreeKey = (key: string) => {\n    return doesComponentExists({ component: key })\n      .then(alreadyExist => {\n        if (this.mounted && key === this.state.projectKey) {\n          if (!alreadyExist) {\n            this.setState({ projectKeyError: undefined, validating: false });\n          } else {\n            this.setState({\n              projectKeyError: translate('onboarding.create_project.project_key.taken'),\n              touched: true,\n              validating: false\n            });\n          }\n        }\n      })\n      .catch(() => {\n        if (this.mounted && key === this.state.projectKey) {\n          this.setState({ projectKeyError: undefined, validating: false });\n        }\n      });\n  };\n\n  canSubmit(state: State): state is ValidState {\n    const { projectKey, projectKeyError, projectName, projectNameError } = state;\n    return Boolean(\n      projectKeyError === undefined &&\n        projectNameError === undefined &&\n        projectKey.length > 0 &&\n        projectName.length > 0\n    );\n  }\n\n  handleFormSubmit = (event: React.FormEvent<HTMLFormElement>) => {\n    event.preventDefault();\n    const { state } = this;\n    if (this.canSubmit(state)) {\n      this.setState({ submitting: true });\n      createProject({\n        project: state.projectKey,\n        name: (state.projectName || state.projectKey).trim()\n      }).then(\n        ({ project }) => this.props.onProjectCreate([project.key]),\n        () => {\n          if (this.mounted) {\n            this.setState({ submitting: false });\n          }\n        }\n      );\n    }\n  };\n\n  handleProjectKeyChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const projectKey = event.currentTarget.value || '';\n    const projectKeyError = this.validateKey(projectKey);\n\n    this.setState(prevState => {\n      const projectName = prevState.projectNameChanged ? prevState.projectName : projectKey;\n      return {\n        projectKey,\n        projectKeyError,\n        projectName,\n        projectNameError: this.validateName(projectName),\n        touched: true,\n        validating: projectKeyError === undefined\n      };\n    });\n\n    if (projectKeyError === undefined) {\n      this.checkFreeKey(projectKey);\n    }\n  };\n\n  handleProjectNameChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const projectName = event.currentTarget.value;\n    this.setState({\n      projectName,\n      projectNameChanged: true,\n      projectNameError: this.validateName(projectName)\n    });\n  };\n\n  validateKey = (projectKey: string) => {\n    const result = validateProjectKey(projectKey);\n    return result === ProjectKeyValidationResult.Valid\n      ? undefined\n      : translate('onboarding.create_project.project_key.error', result);\n  };\n\n  validateName = (projectName: string) => {\n    if (projectName.length === 0) {\n      return translate('onboarding.create_project.display_name.error.empty');\n    } else if (projectName.length > PROJECT_NAME_MAX_LEN) {\n      return translate('onboarding.create_project.display_name.error.too_long');\n    }\n    return undefined;\n  };\n\n  render() {\n    const {\n      projectKey,\n      projectKeyError,\n      projectName,\n      projectNameError,\n      submitting,\n      touched,\n      validating\n    } = this.state;\n    const projectNameIsInvalid = touched && projectNameError !== undefined;\n    const projectNameIsValid = touched && projectNameError === undefined;\n\n    return (\n      <>\n        <CreateProjectPageHeader title={translate('onboarding.create_project.setup_manually')} />\n\n        <div className=\"create-project-manual\">\n          <div className=\"flex-1 huge-spacer-right\">\n            <form className=\"manual-project-create\" onSubmit={this.handleFormSubmit}>\n              <MandatoryFieldsExplanation className=\"big-spacer-bottom\" />\n\n              <ProjectKeyInput\n                error={projectKeyError}\n                help={translate('onboarding.create_project.project_key.help')}\n                label={translate('onboarding.create_project.project_key')}\n                onProjectKeyChange={this.handleProjectKeyChange}\n                projectKey={projectKey}\n                touched={touched}\n                validating={validating}\n              />\n\n              <ValidationInput\n                className=\"form-field\"\n                description={translate('onboarding.create_project.display_name.description')}\n                error={projectNameError}\n                help={translate('onboarding.create_project.display_name.help')}\n                id=\"project-name\"\n                isInvalid={projectNameIsInvalid}\n                isValid={projectNameIsValid}\n                label={translate('onboarding.create_project.display_name')}\n                required={true}>\n                <input\n                  className={classNames('input-super-large', {\n                    'is-invalid': projectNameIsInvalid,\n                    'is-valid': projectNameIsValid\n                  })}\n                  id=\"project-name\"\n                  maxLength={PROJECT_NAME_MAX_LEN}\n                  minLength={1}\n                  onChange={this.handleProjectNameChange}\n                  type=\"text\"\n                  value={projectName}\n                />\n              </ValidationInput>\n\n              <SubmitButton disabled={!this.canSubmit(this.state) || submitting}>\n                {translate('set_up')}\n              </SubmitButton>\n              <DeferredSpinner className=\"spacer-left\" loading={submitting} />\n            </form>\n          </div>\n        </div>\n      </>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Helmet } from 'react-helmet-async';\nimport { WithRouterProps } from 'react-router';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { getAlmSettings } from '../../../api/alm-settings';\nimport A11ySkipTarget from '../../../app/components/a11y/A11ySkipTarget';\nimport { whenLoggedIn } from '../../../components/hoc/whenLoggedIn';\nimport { withAppState } from '../../../components/hoc/withAppState';\nimport { getProjectUrl } from '../../../helpers/urls';\nimport { AlmKeys, AlmSettingsInstance } from '../../../types/alm-settings';\nimport AzureProjectCreate from './AzureProjectCreate';\nimport BitbucketProjectCreate from './BitbucketProjectCreate';\nimport CreateProjectModeSelection from './CreateProjectModeSelection';\nimport GitHubProjectCreate from './GitHubProjectCreate';\nimport GitlabProjectCreate from './GitlabProjectCreate';\nimport ManualProjectCreate from './ManualProjectCreate';\nimport './style.css';\nimport { CreateProjectModes } from './types';\n\ninterface Props extends Pick<WithRouterProps, 'router' | 'location'> {\n  appState: Pick<T.AppState, 'canAdmin'>;\n  currentUser: T.LoggedInUser;\n}\n\ninterface State {\n  azureSettings: AlmSettingsInstance[];\n  bitbucketSettings: AlmSettingsInstance[];\n  githubSettings: AlmSettingsInstance[];\n  gitlabSettings: AlmSettingsInstance[];\n  loading: boolean;\n}\n\nexport class CreateProjectPage extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = {\n    azureSettings: [],\n    bitbucketSettings: [],\n    githubSettings: [],\n    gitlabSettings: [],\n    loading: true\n  };\n\n  componentDidMount() {\n    this.mounted = true;\n    this.fetchAlmBindings();\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  fetchAlmBindings = () => {\n    this.setState({ loading: true });\n    getAlmSettings()\n      .then(almSettings => {\n        if (this.mounted) {\n          this.setState({\n            azureSettings: almSettings.filter(s => s.alm === AlmKeys.Azure),\n            bitbucketSettings: almSettings.filter(s => s.alm === AlmKeys.BitbucketServer),\n            githubSettings: almSettings.filter(s => s.alm === AlmKeys.GitHub),\n            gitlabSettings: almSettings.filter(s => s.alm === AlmKeys.GitLab),\n            loading: false\n          });\n        }\n      })\n      .catch(() => {\n        if (this.mounted) {\n          this.setState({ loading: false });\n        }\n      });\n  };\n\n  handleModeSelect = (mode: CreateProjectModes) => {\n    const { router, location } = this.props;\n    router.push({\n      pathname: location.pathname,\n      query: { mode }\n    });\n  };\n\n  handleProjectCreate = (projectKeys: string[]) => {\n    if (projectKeys.length === 1) {\n      this.props.router.push(getProjectUrl(projectKeys[0]));\n    }\n  };\n\n  renderForm(mode?: CreateProjectModes) {\n    const {\n      appState: { canAdmin },\n      location,\n      router\n    } = this.props;\n    const {\n      azureSettings,\n      bitbucketSettings,\n      githubSettings,\n      gitlabSettings,\n      loading\n    } = this.state;\n\n    switch (mode) {\n      case CreateProjectModes.AzureDevOps: {\n        return (\n          <AzureProjectCreate\n            canAdmin={!!canAdmin}\n            loadingBindings={loading}\n            location={location}\n            onProjectCreate={this.handleProjectCreate}\n            router={router}\n            settings={azureSettings}\n          />\n        );\n      }\n      case CreateProjectModes.BitbucketServer: {\n        return (\n          <BitbucketProjectCreate\n            canAdmin={!!canAdmin}\n            bitbucketSettings={bitbucketSettings}\n            loadingBindings={loading}\n            location={location}\n            onProjectCreate={this.handleProjectCreate}\n          />\n        );\n      }\n      case CreateProjectModes.GitHub: {\n        return (\n          <GitHubProjectCreate\n            canAdmin={!!canAdmin}\n            loadingBindings={loading}\n            location={location}\n            onProjectCreate={this.handleProjectCreate}\n            router={router}\n            settings={githubSettings}\n          />\n        );\n      }\n      case CreateProjectModes.GitLab: {\n        return (\n          <GitlabProjectCreate\n            canAdmin={!!canAdmin}\n            loadingBindings={loading}\n            location={location}\n            onProjectCreate={this.handleProjectCreate}\n            router={router}\n            settings={gitlabSettings}\n          />\n        );\n      }\n      case CreateProjectModes.Manual: {\n        return <ManualProjectCreate onProjectCreate={this.handleProjectCreate} />;\n      }\n      default: {\n        const almCounts = {\n          [AlmKeys.Azure]: azureSettings.length,\n          [AlmKeys.BitbucketServer]: bitbucketSettings.length,\n          [AlmKeys.GitHub]: githubSettings.length,\n          [AlmKeys.GitLab]: gitlabSettings.length\n        };\n        return (\n          <CreateProjectModeSelection\n            almCounts={almCounts}\n            loadingBindings={loading}\n            onSelectMode={this.handleModeSelect}\n          />\n        );\n      }\n    }\n  }\n\n  render() {\n    const { location } = this.props;\n    const mode: CreateProjectModes | undefined = location.query?.mode;\n\n    return (\n      <>\n        <Helmet title={translate('my_account.create_new.TRK')} titleTemplate=\"%s\" />\n        <A11ySkipTarget anchor=\"create_project_main\" />\n        <div className=\"page page-limited huge-spacer-bottom position-relative\" id=\"create-project\">\n          {this.renderForm(mode)}\n        </div>\n      </>\n    );\n  }\n}\n\nexport default whenLoggedIn(withAppState(CreateProjectPage));\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { A11yContext } from './A11yContext';\n\ninterface Props {\n  anchor: string;\n  label?: string;\n  weight?: number;\n}\n\nexport default function A11ySkipTarget(props: Props) {\n  return (\n    <A11yContext.Consumer>\n      {({ addA11ySkipLink, removeA11ySkipLink }) => (\n        <A11ySkipTargetInner\n          addA11ySkipLink={addA11ySkipLink}\n          removeA11ySkipLink={removeA11ySkipLink}\n          {...props}\n        />\n      )}\n    </A11yContext.Consumer>\n  );\n}\n\ninterface InnerProps {\n  addA11ySkipLink: (link: T.A11ySkipLink) => void;\n  removeA11ySkipLink: (link: T.A11ySkipLink) => void;\n}\n\nexport class A11ySkipTargetInner extends React.PureComponent<Props & InnerProps> {\n  componentDidMount() {\n    this.props.addA11ySkipLink(this.getLink());\n  }\n\n  componentWillUnmount() {\n    this.props.removeA11ySkipLink(this.getLink());\n  }\n\n  getLink = (): T.A11ySkipLink => {\n    const { anchor: key, label = translate('skip_to_content'), weight } = this.props;\n    return { key, label, weight };\n  };\n\n  render() {\n    const { anchor } = this.props;\n    return <span id={`a11y_target__${anchor}`} />;\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { get, getJSON, HttpStatus, parseError, post } from 'sonar-ui-common/helpers/request';\nimport throwGlobalError from '../app/utils/throwGlobalError';\nimport {\n  AlmSettingsBindingDefinitions,\n  AlmSettingsInstance,\n  AzureBindingDefinition,\n  AzureProjectAlmBindingParams,\n  BitbucketBindingDefinition,\n  BitbucketCloudBindingDefinition,\n  BitbucketCloudProjectAlmBindingParams,\n  BitbucketProjectAlmBindingParams,\n  GithubBindingDefinition,\n  GithubProjectAlmBindingParams,\n  GitlabBindingDefinition,\n  GitlabProjectAlmBindingParams,\n  ProjectAlmBindingResponse\n} from '../types/alm-settings';\n\nexport function getAlmDefinitions(): Promise<AlmSettingsBindingDefinitions> {\n  return getJSON('/api/alm_settings/list_definitions');\n}\n\nexport function getAlmSettings(project?: string): Promise<AlmSettingsInstance[]> {\n  return getAlmSettingsNoCatch(project).catch(throwGlobalError);\n}\n\nexport function getAlmSettingsNoCatch(project?: string): Promise<AlmSettingsInstance[]> {\n  return getJSON('/api/alm_settings/list', { project }).then(({ almSettings }) => almSettings);\n}\n\nexport function validateAlmSettings(key: string): Promise<string> {\n  return get('/api/alm_settings/validate', { key })\n    .then(() => {\n      return '';\n    })\n    .catch((response: Response) => {\n      if (response.status === HttpStatus.BadRequest) {\n        return parseError(response);\n      } else {\n        return throwGlobalError(response);\n      }\n    });\n}\n\nexport function createGithubConfiguration(data: GithubBindingDefinition) {\n  return post('/api/alm_settings/create_github', data).catch(throwGlobalError);\n}\n\nexport function updateGithubConfiguration(data: GithubBindingDefinition & { newKey: string }) {\n  return post('/api/alm_settings/update_github', data).catch(throwGlobalError);\n}\n\nexport function createAzureConfiguration(data: AzureBindingDefinition) {\n  return post('/api/alm_settings/create_azure', data).catch(throwGlobalError);\n}\n\nexport function updateAzureConfiguration(data: AzureBindingDefinition & { newKey: string }) {\n  return post('/api/alm_settings/update_azure', data).catch(throwGlobalError);\n}\n\nexport function createBitbucketConfiguration(data: BitbucketBindingDefinition) {\n  return post('/api/alm_settings/create_bitbucket', data).catch(throwGlobalError);\n}\n\nexport function updateBitbucketConfiguration(\n  data: BitbucketBindingDefinition & { newKey: string }\n) {\n  return post('/api/alm_settings/update_bitbucket', data).catch(throwGlobalError);\n}\n\nexport function createBitbucketCloudConfiguration(data: BitbucketCloudBindingDefinition) {\n  return post('/api/alm_settings/create_bitbucketcloud', data).catch(throwGlobalError);\n}\n\nexport function updateBitbucketCloudConfiguration(\n  data: BitbucketCloudBindingDefinition & { newKey: string }\n) {\n  return post('/api/alm_settings/update_bitbucketcloud', data).catch(throwGlobalError);\n}\n\nexport function createGitlabConfiguration(data: GitlabBindingDefinition) {\n  return post('/api/alm_settings/create_gitlab', data).catch(throwGlobalError);\n}\n\nexport function updateGitlabConfiguration(data: GitlabBindingDefinition & { newKey: string }) {\n  return post('/api/alm_settings/update_gitlab', data).catch(throwGlobalError);\n}\n\nexport function deleteConfiguration(key: string) {\n  return post('/api/alm_settings/delete', { key }).catch(throwGlobalError);\n}\n\nexport function countBindedProjects(almSetting: string) {\n  return getJSON('/api/alm_settings/count_binding', { almSetting })\n    .then(({ projects }) => projects)\n    .catch(throwGlobalError);\n}\n\nexport function getProjectAlmBinding(project: string): Promise<ProjectAlmBindingResponse> {\n  return getJSON('/api/alm_settings/get_binding', { project });\n}\n\nexport function deleteProjectAlmBinding(project: string): Promise<void> {\n  return post('/api/alm_settings/delete_binding', { project }).catch(throwGlobalError);\n}\n\nexport function setProjectAzureBinding(data: AzureProjectAlmBindingParams) {\n  return post('/api/alm_settings/set_azure_binding', data).catch(throwGlobalError);\n}\n\nexport function setProjectBitbucketBinding(data: BitbucketProjectAlmBindingParams) {\n  return post('/api/alm_settings/set_bitbucket_binding', data).catch(throwGlobalError);\n}\n\nexport function setProjectBitbucketCloudBinding(data: BitbucketCloudProjectAlmBindingParams) {\n  return post('/api/alm_settings/set_bitbucketcloud_binding', data).catch(throwGlobalError);\n}\n\nexport function setProjectGithubBinding(data: GithubProjectAlmBindingParams) {\n  return post('/api/alm_settings/set_github_binding', data).catch(throwGlobalError);\n}\n\nexport function setProjectGitlabBinding(data: GitlabProjectAlmBindingParams) {\n  return post('/api/alm_settings/set_gitlab_binding', data).catch(throwGlobalError);\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Link } from 'react-router';\nimport HelpTooltip from 'sonar-ui-common/components/controls/HelpTooltip';\nimport DetachIcon from 'sonar-ui-common/components/icons/DetachIcon';\nimport { isWebUri } from 'valid-url';\n\nexport interface DocumentationTooltipProps {\n  children?: React.ReactNode;\n  className?: string;\n  content?: React.ReactNode;\n  links?: Array<{ href: string; label: string; inPlace?: boolean }>;\n  title?: string;\n}\n\nexport default function DocumentationTooltip(props: DocumentationTooltipProps) {\n  const { className, content, links, title } = props;\n\n  return (\n    <HelpTooltip\n      className={className}\n      overlay={\n        <div className=\"big-padded-top big-padded-bottom\">\n          {title && (\n            <div className=\"spacer-bottom\">\n              <strong>{title}</strong>\n            </div>\n          )}\n\n          {content && <p>{content}</p>}\n\n          {links && (\n            <>\n              <hr className=\"big-spacer-top big-spacer-bottom\" />\n\n              {links.map(({ href, label, inPlace }) => (\n                <div className=\"little-spacer-bottom\" key={label}>\n                  {inPlace ? (\n                    <Link to={href}>\n                      <span>{label}</span>\n                    </Link>\n                  ) : (\n                    <a\n                      className=\"display-inline-flex-center link-with-icon\"\n                      href={href}\n                      rel=\"noopener noreferrer\"\n                      target=\"_blank\">\n                      {isWebUri(href) && <DetachIcon size={14} className=\"spacer-right\" />}\n                      <span>{label}</span>\n                    </a>\n                  )}\n                </div>\n              ))}\n            </>\n          )}\n        </div>\n      }>\n      {props.children}\n    </HelpTooltip>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nexport const ALM_INTEGRATION = 'almintegration';\nexport const ANALYSIS_SCOPE_CATEGORY = 'exclusions';\nexport const LANGUAGES_CATEGORY = 'languages';\nexport const NEW_CODE_PERIOD_CATEGORY = 'new_code_period';\nexport const PULL_REQUEST_DECORATION_BINDING_CATEGORY = 'pull_request_decoration_binding';\n","/*\n * SonarQube\n * Copyright (C) 2009-2022 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport handleRequiredAuthentication from 'sonar-ui-common/helpers/handleRequiredAuthentication';\nimport { isLoggedIn } from '../../helpers/users';\nimport { getWrappedDisplayName } from './utils';\nimport { withCurrentUser } from './withCurrentUser';\n\nexport function whenLoggedIn<P>(WrappedComponent: React.ComponentType<P>) {\n  class Wrapper extends React.Component<P & { currentUser: T.CurrentUser }> {\n    static displayName = getWrappedDisplayName(WrappedComponent, 'whenLoggedIn');\n\n    componentDidMount() {\n      if (!isLoggedIn(this.props.currentUser)) {\n        handleRequiredAuthentication();\n      }\n    }\n\n    render() {\n      if (isLoggedIn(this.props.currentUser)) {\n        return <WrappedComponent {...this.props} />;\n      } else {\n        return null;\n      }\n    }\n  }\n\n  return withCurrentUser(Wrapper);\n}\n"],"sourceRoot":""}